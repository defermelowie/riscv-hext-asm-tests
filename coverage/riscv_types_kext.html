<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>riscv_types_kext</title></head>
<body>
<h1>riscv_types_kext.sail (0/45) 0%</h1>
<code style="display: block">
/*=======================================================================================*/<br>
/*&nbsp;&nbsp;RISCV&nbsp;Sail&nbsp;Model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;Sail&nbsp;RISC-V&nbsp;architecture&nbsp;model,&nbsp;comprising&nbsp;all&nbsp;files&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;directories&nbsp;except&nbsp;for&nbsp;the&nbsp;snapshots&nbsp;of&nbsp;the&nbsp;Lem&nbsp;and&nbsp;Sail&nbsp;libraries&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;in&nbsp;the&nbsp;prover_snapshots&nbsp;directory&nbsp;(which&nbsp;include&nbsp;copies&nbsp;of&nbsp;their&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;licences),&nbsp;is&nbsp;subject&nbsp;to&nbsp;the&nbsp;BSD&nbsp;two-clause&nbsp;licence&nbsp;below.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Copyright&nbsp;(c)&nbsp;2017-2023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Prashanth&nbsp;Mundkur&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Rishiyur&nbsp;S.&nbsp;Nikhil&nbsp;and&nbsp;Bluespec,&nbsp;Inc.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Jon&nbsp;French&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Brian&nbsp;Campbell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Robert&nbsp;Norton-Wright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Alasdair&nbsp;Armstrong&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Thomas&nbsp;Bauereiss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Shaked&nbsp;Flur&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Christopher&nbsp;Pulte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Peter&nbsp;Sewell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Alexander&nbsp;Richardson&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Hesham&nbsp;Almatary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Jessica&nbsp;Clarke&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Microsoft,&nbsp;for&nbsp;contributions&nbsp;by&nbsp;Robert&nbsp;Norton-Wright&nbsp;and&nbsp;Nathaniel&nbsp;Wesley&nbsp;Filardo&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Peter&nbsp;Rugg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Aril&nbsp;Computer&nbsp;Corp.,&nbsp;for&nbsp;contributions&nbsp;by&nbsp;Scott&nbsp;Johnson&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Philipp&nbsp;Tomsich&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;VRULL&nbsp;GmbH,&nbsp;for&nbsp;contributions&nbsp;by&nbsp;its&nbsp;employees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;software&nbsp;was&nbsp;developed&nbsp;by&nbsp;the&nbsp;above&nbsp;within&nbsp;the&nbsp;Rigorous&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Engineering&nbsp;of&nbsp;Mainstream&nbsp;Systems&nbsp;(REMS)&nbsp;project,&nbsp;partly&nbsp;funded&nbsp;by&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;EPSRC&nbsp;grant&nbsp;EP/K008528/1,&nbsp;at&nbsp;the&nbsp;Universities&nbsp;of&nbsp;Cambridge&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Edinburgh.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;software&nbsp;was&nbsp;developed&nbsp;by&nbsp;SRI&nbsp;International&nbsp;and&nbsp;the&nbsp;University&nbsp;of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Cambridge&nbsp;Computer&nbsp;Laboratory&nbsp;(Department&nbsp;of&nbsp;Computer&nbsp;Science&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Technology)&nbsp;under&nbsp;DARPA/AFRL&nbsp;contract&nbsp;FA8650-18-C-7809&nbsp;(&quot;CIFV&quot;),&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;under&nbsp;DARPA&nbsp;contract&nbsp;HR0011-18-C-0016&nbsp;(&quot;ECATS&quot;)&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;DARPA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SSITH&nbsp;research&nbsp;programme.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;project&nbsp;has&nbsp;received&nbsp;funding&nbsp;from&nbsp;the&nbsp;European&nbsp;Research&nbsp;Council&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;(ERC)&nbsp;under&nbsp;the&nbsp;European&nbsp;Unionâ€™s&nbsp;Horizon&nbsp;2020&nbsp;research&nbsp;and&nbsp;innovation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;programme&nbsp;(grant&nbsp;agreement&nbsp;789108,&nbsp;ELVER).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Redistribution&nbsp;and&nbsp;use&nbsp;in&nbsp;source&nbsp;and&nbsp;binary&nbsp;forms,&nbsp;with&nbsp;or&nbsp;without&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;modification,&nbsp;are&nbsp;permitted&nbsp;provided&nbsp;that&nbsp;the&nbsp;following&nbsp;conditions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;are&nbsp;met:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;1.&nbsp;Redistributions&nbsp;of&nbsp;source&nbsp;code&nbsp;must&nbsp;retain&nbsp;the&nbsp;above&nbsp;copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;2.&nbsp;Redistributions&nbsp;in&nbsp;binary&nbsp;form&nbsp;must&nbsp;reproduce&nbsp;the&nbsp;above&nbsp;copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer&nbsp;in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;documentation&nbsp;and/or&nbsp;other&nbsp;materials&nbsp;provided&nbsp;with&nbsp;the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribution.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHOR&nbsp;AND&nbsp;CONTRIBUTORS&nbsp;``AS&nbsp;IS''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS&nbsp;OR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;TO,&nbsp;THE&nbsp;IMPLIED&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;PARTICULAR&nbsp;PURPOSE&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHOR&nbsp;OR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;CONTRIBUTORS&nbsp;BE&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,&nbsp;EVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SUCH&nbsp;DAMAGE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*=======================================================================================*/<br>
<br>
/*<br>
&nbsp;*&nbsp;This&nbsp;file&nbsp;contains&nbsp;types,&nbsp;mappings&nbsp;and&nbsp;functions&nbsp;used&nbsp;across&nbsp;the<br>
&nbsp;*&nbsp;cryptography&nbsp;extension&nbsp;instructions.<br>
&nbsp;*<br>
&nbsp;*&nbsp;This&nbsp;file&nbsp;must&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;model&nbsp;build&nbsp;whatever&nbsp;the&nbsp;value&nbsp;of&nbsp;XLEN.<br>
&nbsp;*/<br>
<br>
/*<br>
&nbsp;*&nbsp;Cryptography&nbsp;extension&nbsp;shared&nbsp;/&nbsp;utility&nbsp;functions<br>
&nbsp;*&nbsp;----------------------------------------------------------------------<br>
&nbsp;*/<br>
<br>
/*&nbsp;Auxiliary&nbsp;function&nbsp;for&nbsp;performing&nbsp;GF&nbsp;multiplicaiton&nbsp;*/<br>
val&nbsp;xt2&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;xt2(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;(x&nbsp;&lt;&lt;&nbsp;1)&nbsp;^&nbsp;(<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;bit_to_bool(x[7])&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x1b</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00</span></span>)<br>
}</span><br>
<br>
val&nbsp;xt3&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;xt3(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">x&nbsp;^&nbsp;xt2(x)</span><br>
<br>
/*&nbsp;Multiply&nbsp;8-bit&nbsp;field&nbsp;element&nbsp;by&nbsp;4-bit&nbsp;value&nbsp;for&nbsp;AES&nbsp;MixCols&nbsp;step&nbsp;*/<br>
val&nbsp;gfmul&nbsp;:&nbsp;(bits(8),&nbsp;bits(4))&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;gfmul(&nbsp;x,&nbsp;y)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;(<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;bit_to_bool(y[0])&nbsp;then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00</span></span>)&nbsp;^<br>
&nbsp;&nbsp;(<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;bit_to_bool(y[1])&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">xt2(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x)</span>&nbsp;&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00</span></span>)&nbsp;^<br>
&nbsp;&nbsp;(<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;bit_to_bool(y[2])&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">xt2(xt2(&nbsp;&nbsp;&nbsp;&nbsp;x))</span>&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00</span></span>)&nbsp;^<br>
&nbsp;&nbsp;(<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;bit_to_bool(y[3])&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">xt2(xt2(xt2(x)))</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00</span></span>)<br>
}</span><br>
<br>
/*&nbsp;8-bit&nbsp;to&nbsp;32-bit&nbsp;partial&nbsp;AES&nbsp;Mix&nbsp;Colum&nbsp;-&nbsp;forwards&nbsp;*/<br>
val&nbsp;aes_mixcolumn_byte_fwd&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_mixcolumn_byte_fwd(so)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;gfmul(so,&nbsp;0x3)&nbsp;@&nbsp;so&nbsp;@&nbsp;so&nbsp;@&nbsp;gfmul(so,&nbsp;0x2)<br>
}</span><br>
<br>
/*&nbsp;8-bit&nbsp;to&nbsp;32-bit&nbsp;partial&nbsp;AES&nbsp;Mix&nbsp;Colum&nbsp;-&nbsp;inverse*/<br>
val&nbsp;aes_mixcolumn_byte_inv&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_mixcolumn_byte_inv(so)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;gfmul(so,&nbsp;0xb)&nbsp;@&nbsp;gfmul(so,&nbsp;0xd)&nbsp;@&nbsp;gfmul(so,&nbsp;0x9)&nbsp;@&nbsp;gfmul(so,&nbsp;0xe)<br>
}</span><br>
<br>
/*&nbsp;32-bit&nbsp;to&nbsp;32-bit&nbsp;AES&nbsp;forward&nbsp;MixColumn&nbsp;*/<br>
val&nbsp;aes_mixcolumn_fwd&nbsp;:&nbsp;bits(32)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_mixcolumn_fwd(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;s0&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;s1&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[15..&nbsp;8];<br>
&nbsp;&nbsp;let&nbsp;s2&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[23..16];<br>
&nbsp;&nbsp;let&nbsp;s3&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[31..24];<br>
&nbsp;&nbsp;let&nbsp;b0&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;xt2(s0)&nbsp;^&nbsp;xt3(s1)&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;(s2)&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;(s3);<br>
&nbsp;&nbsp;let&nbsp;b1&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;(s0)&nbsp;^&nbsp;xt2(s1)&nbsp;^&nbsp;xt3(s2)&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;(s3);<br>
&nbsp;&nbsp;let&nbsp;b2&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;(s0)&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;(s1)&nbsp;^&nbsp;xt2(s2)&nbsp;^&nbsp;xt3(s3);<br>
&nbsp;&nbsp;let&nbsp;b3&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;xt3(s0)&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;(s1)&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;(s2)&nbsp;^&nbsp;xt2(s3);<br>
&nbsp;&nbsp;b3&nbsp;@&nbsp;b2&nbsp;@&nbsp;b1&nbsp;@&nbsp;b0&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}</span><br>
<br>
/*&nbsp;32-bit&nbsp;to&nbsp;32-bit&nbsp;AES&nbsp;inverse&nbsp;MixColumn&nbsp;*/<br>
val&nbsp;aes_mixcolumn_inv&nbsp;:&nbsp;bits(32)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_mixcolumn_inv(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;s0&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;s1&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[15..&nbsp;8];<br>
&nbsp;&nbsp;let&nbsp;s2&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[23..16];<br>
&nbsp;&nbsp;let&nbsp;s3&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;x[31..24];<br>
&nbsp;&nbsp;let&nbsp;b0&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;gfmul(s0,&nbsp;0xE)&nbsp;^&nbsp;gfmul(s1,&nbsp;0xB)&nbsp;^&nbsp;gfmul(s2,&nbsp;0xD)&nbsp;^&nbsp;gfmul(s3,&nbsp;0x9);<br>
&nbsp;&nbsp;let&nbsp;b1&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;gfmul(s0,&nbsp;0x9)&nbsp;^&nbsp;gfmul(s1,&nbsp;0xE)&nbsp;^&nbsp;gfmul(s2,&nbsp;0xB)&nbsp;^&nbsp;gfmul(s3,&nbsp;0xD);<br>
&nbsp;&nbsp;let&nbsp;b2&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;gfmul(s0,&nbsp;0xD)&nbsp;^&nbsp;gfmul(s1,&nbsp;0x9)&nbsp;^&nbsp;gfmul(s2,&nbsp;0xE)&nbsp;^&nbsp;gfmul(s3,&nbsp;0xB);<br>
&nbsp;&nbsp;let&nbsp;b3&nbsp;:&nbsp;bits&nbsp;(8)&nbsp;=&nbsp;gfmul(s0,&nbsp;0xB)&nbsp;^&nbsp;gfmul(s1,&nbsp;0xD)&nbsp;^&nbsp;gfmul(s2,&nbsp;0x9)&nbsp;^&nbsp;gfmul(s3,&nbsp;0xE);<br>
&nbsp;&nbsp;b3&nbsp;@&nbsp;b2&nbsp;@&nbsp;b1&nbsp;@&nbsp;b0&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}</span><br>
<br>
/*&nbsp;Turn&nbsp;a&nbsp;round&nbsp;number&nbsp;into&nbsp;a&nbsp;round&nbsp;constant&nbsp;for&nbsp;AES.&nbsp;Note&nbsp;that&nbsp;the<br>
&nbsp;&nbsp;&nbsp;AES64KS1I&nbsp;instruction&nbsp;is&nbsp;defined&nbsp;such&nbsp;that&nbsp;the&nbsp;r&nbsp;argument&nbsp;is&nbsp;always<br>
&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;range&nbsp;0x0..0xA.&nbsp;Values&nbsp;of&nbsp;rnum&nbsp;outside&nbsp;the&nbsp;range&nbsp;0x0..0xA<br>
&nbsp;&nbsp;&nbsp;do&nbsp;not&nbsp;decode&nbsp;to&nbsp;the&nbsp;AES64KS1I&nbsp;instruction.&nbsp;The&nbsp;0xA&nbsp;case&nbsp;is&nbsp;used<br>
&nbsp;&nbsp;&nbsp;specifically&nbsp;for&nbsp;the&nbsp;AES-256&nbsp;KeySchedule,&nbsp;and&nbsp;this&nbsp;function&nbsp;is&nbsp;never<br>
&nbsp;&nbsp;&nbsp;called&nbsp;in&nbsp;that&nbsp;case.&nbsp;*/<br>
val&nbsp;aes_decode_rcon&nbsp;:&nbsp;bits(4)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_decode_rcon(r)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;assert(r&nbsp;&lt;_u&nbsp;0xA);<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">match&nbsp;r&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x0&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000001</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x1&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000002</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x2&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000004</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x3&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000008</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x4&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000010</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x5&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000020</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x6&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000040</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x7&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000080</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x8&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x0000001b</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;0x9&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">0x00000036</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">internal_error(__FILE__,&nbsp;__LINE__,&nbsp;&quot;Unexpected&nbsp;AES&nbsp;r&quot;)</span>&nbsp;/*&nbsp;unreachable&nbsp;--&nbsp;required&nbsp;to&nbsp;silence&nbsp;Sail&nbsp;warning&nbsp;*/<br>
&nbsp;&nbsp;}</span><br>
}</span><br>
<br>
/*&nbsp;SM4&nbsp;SBox&nbsp;-&nbsp;only&nbsp;one&nbsp;sbox&nbsp;for&nbsp;forwards&nbsp;and&nbsp;inverse&nbsp;*/<br>
let&nbsp;sm4_sbox_table&nbsp;:&nbsp;vector(256,&nbsp;bits(8))&nbsp;=&nbsp;[<br>
0xD6,&nbsp;0x90,&nbsp;0xE9,&nbsp;0xFE,&nbsp;0xCC,&nbsp;0xE1,&nbsp;0x3D,&nbsp;0xB7,&nbsp;0x16,&nbsp;0xB6,&nbsp;0x14,&nbsp;0xC2,&nbsp;0x28,<br>
0xFB,&nbsp;0x2C,&nbsp;0x05,&nbsp;0x2B,&nbsp;0x67,&nbsp;0x9A,&nbsp;0x76,&nbsp;0x2A,&nbsp;0xBE,&nbsp;0x04,&nbsp;0xC3,&nbsp;0xAA,&nbsp;0x44,<br>
0x13,&nbsp;0x26,&nbsp;0x49,&nbsp;0x86,&nbsp;0x06,&nbsp;0x99,&nbsp;0x9C,&nbsp;0x42,&nbsp;0x50,&nbsp;0xF4,&nbsp;0x91,&nbsp;0xEF,&nbsp;0x98,<br>
0x7A,&nbsp;0x33,&nbsp;0x54,&nbsp;0x0B,&nbsp;0x43,&nbsp;0xED,&nbsp;0xCF,&nbsp;0xAC,&nbsp;0x62,&nbsp;0xE4,&nbsp;0xB3,&nbsp;0x1C,&nbsp;0xA9,<br>
0xC9,&nbsp;0x08,&nbsp;0xE8,&nbsp;0x95,&nbsp;0x80,&nbsp;0xDF,&nbsp;0x94,&nbsp;0xFA,&nbsp;0x75,&nbsp;0x8F,&nbsp;0x3F,&nbsp;0xA6,&nbsp;0x47,<br>
0x07,&nbsp;0xA7,&nbsp;0xFC,&nbsp;0xF3,&nbsp;0x73,&nbsp;0x17,&nbsp;0xBA,&nbsp;0x83,&nbsp;0x59,&nbsp;0x3C,&nbsp;0x19,&nbsp;0xE6,&nbsp;0x85,<br>
0x4F,&nbsp;0xA8,&nbsp;0x68,&nbsp;0x6B,&nbsp;0x81,&nbsp;0xB2,&nbsp;0x71,&nbsp;0x64,&nbsp;0xDA,&nbsp;0x8B,&nbsp;0xF8,&nbsp;0xEB,&nbsp;0x0F,<br>
0x4B,&nbsp;0x70,&nbsp;0x56,&nbsp;0x9D,&nbsp;0x35,&nbsp;0x1E,&nbsp;0x24,&nbsp;0x0E,&nbsp;0x5E,&nbsp;0x63,&nbsp;0x58,&nbsp;0xD1,&nbsp;0xA2,<br>
0x25,&nbsp;0x22,&nbsp;0x7C,&nbsp;0x3B,&nbsp;0x01,&nbsp;0x21,&nbsp;0x78,&nbsp;0x87,&nbsp;0xD4,&nbsp;0x00,&nbsp;0x46,&nbsp;0x57,&nbsp;0x9F,<br>
0xD3,&nbsp;0x27,&nbsp;0x52,&nbsp;0x4C,&nbsp;0x36,&nbsp;0x02,&nbsp;0xE7,&nbsp;0xA0,&nbsp;0xC4,&nbsp;0xC8,&nbsp;0x9E,&nbsp;0xEA,&nbsp;0xBF,<br>
0x8A,&nbsp;0xD2,&nbsp;0x40,&nbsp;0xC7,&nbsp;0x38,&nbsp;0xB5,&nbsp;0xA3,&nbsp;0xF7,&nbsp;0xF2,&nbsp;0xCE,&nbsp;0xF9,&nbsp;0x61,&nbsp;0x15,<br>
0xA1,&nbsp;0xE0,&nbsp;0xAE,&nbsp;0x5D,&nbsp;0xA4,&nbsp;0x9B,&nbsp;0x34,&nbsp;0x1A,&nbsp;0x55,&nbsp;0xAD,&nbsp;0x93,&nbsp;0x32,&nbsp;0x30,<br>
0xF5,&nbsp;0x8C,&nbsp;0xB1,&nbsp;0xE3,&nbsp;0x1D,&nbsp;0xF6,&nbsp;0xE2,&nbsp;0x2E,&nbsp;0x82,&nbsp;0x66,&nbsp;0xCA,&nbsp;0x60,&nbsp;0xC0,<br>
0x29,&nbsp;0x23,&nbsp;0xAB,&nbsp;0x0D,&nbsp;0x53,&nbsp;0x4E,&nbsp;0x6F,&nbsp;0xD5,&nbsp;0xDB,&nbsp;0x37,&nbsp;0x45,&nbsp;0xDE,&nbsp;0xFD,<br>
0x8E,&nbsp;0x2F,&nbsp;0x03,&nbsp;0xFF,&nbsp;0x6A,&nbsp;0x72,&nbsp;0x6D,&nbsp;0x6C,&nbsp;0x5B,&nbsp;0x51,&nbsp;0x8D,&nbsp;0x1B,&nbsp;0xAF,<br>
0x92,&nbsp;0xBB,&nbsp;0xDD,&nbsp;0xBC,&nbsp;0x7F,&nbsp;0x11,&nbsp;0xD9,&nbsp;0x5C,&nbsp;0x41,&nbsp;0x1F,&nbsp;0x10,&nbsp;0x5A,&nbsp;0xD8,<br>
0x0A,&nbsp;0xC1,&nbsp;0x31,&nbsp;0x88,&nbsp;0xA5,&nbsp;0xCD,&nbsp;0x7B,&nbsp;0xBD,&nbsp;0x2D,&nbsp;0x74,&nbsp;0xD0,&nbsp;0x12,&nbsp;0xB8,<br>
0xE5,&nbsp;0xB4,&nbsp;0xB0,&nbsp;0x89,&nbsp;0x69,&nbsp;0x97,&nbsp;0x4A,&nbsp;0x0C,&nbsp;0x96,&nbsp;0x77,&nbsp;0x7E,&nbsp;0x65,&nbsp;0xB9,<br>
0xF1,&nbsp;0x09,&nbsp;0xC5,&nbsp;0x6E,&nbsp;0xC6,&nbsp;0x84,&nbsp;0x18,&nbsp;0xF0,&nbsp;0x7D,&nbsp;0xEC,&nbsp;0x3A,&nbsp;0xDC,&nbsp;0x4D,<br>
0x20,&nbsp;0x79,&nbsp;0xEE,&nbsp;0x5F,&nbsp;0x3E,&nbsp;0xD7,&nbsp;0xCB,&nbsp;0x39,&nbsp;0x48<br>
]<br>
<br>
let&nbsp;aes_sbox_fwd_table&nbsp;:&nbsp;vector(256,&nbsp;bits(8))&nbsp;=&nbsp;[<br>
0x63,&nbsp;0x7c,&nbsp;0x77,&nbsp;0x7b,&nbsp;0xf2,&nbsp;0x6b,&nbsp;0x6f,&nbsp;0xc5,&nbsp;0x30,&nbsp;0x01,&nbsp;0x67,&nbsp;0x2b,&nbsp;0xfe,<br>
0xd7,&nbsp;0xab,&nbsp;0x76,&nbsp;0xca,&nbsp;0x82,&nbsp;0xc9,&nbsp;0x7d,&nbsp;0xfa,&nbsp;0x59,&nbsp;0x47,&nbsp;0xf0,&nbsp;0xad,&nbsp;0xd4,<br>
0xa2,&nbsp;0xaf,&nbsp;0x9c,&nbsp;0xa4,&nbsp;0x72,&nbsp;0xc0,&nbsp;0xb7,&nbsp;0xfd,&nbsp;0x93,&nbsp;0x26,&nbsp;0x36,&nbsp;0x3f,&nbsp;0xf7,<br>
0xcc,&nbsp;0x34,&nbsp;0xa5,&nbsp;0xe5,&nbsp;0xf1,&nbsp;0x71,&nbsp;0xd8,&nbsp;0x31,&nbsp;0x15,&nbsp;0x04,&nbsp;0xc7,&nbsp;0x23,&nbsp;0xc3,<br>
0x18,&nbsp;0x96,&nbsp;0x05,&nbsp;0x9a,&nbsp;0x07,&nbsp;0x12,&nbsp;0x80,&nbsp;0xe2,&nbsp;0xeb,&nbsp;0x27,&nbsp;0xb2,&nbsp;0x75,&nbsp;0x09,<br>
0x83,&nbsp;0x2c,&nbsp;0x1a,&nbsp;0x1b,&nbsp;0x6e,&nbsp;0x5a,&nbsp;0xa0,&nbsp;0x52,&nbsp;0x3b,&nbsp;0xd6,&nbsp;0xb3,&nbsp;0x29,&nbsp;0xe3,<br>
0x2f,&nbsp;0x84,&nbsp;0x53,&nbsp;0xd1,&nbsp;0x00,&nbsp;0xed,&nbsp;0x20,&nbsp;0xfc,&nbsp;0xb1,&nbsp;0x5b,&nbsp;0x6a,&nbsp;0xcb,&nbsp;0xbe,<br>
0x39,&nbsp;0x4a,&nbsp;0x4c,&nbsp;0x58,&nbsp;0xcf,&nbsp;0xd0,&nbsp;0xef,&nbsp;0xaa,&nbsp;0xfb,&nbsp;0x43,&nbsp;0x4d,&nbsp;0x33,&nbsp;0x85,<br>
0x45,&nbsp;0xf9,&nbsp;0x02,&nbsp;0x7f,&nbsp;0x50,&nbsp;0x3c,&nbsp;0x9f,&nbsp;0xa8,&nbsp;0x51,&nbsp;0xa3,&nbsp;0x40,&nbsp;0x8f,&nbsp;0x92,<br>
0x9d,&nbsp;0x38,&nbsp;0xf5,&nbsp;0xbc,&nbsp;0xb6,&nbsp;0xda,&nbsp;0x21,&nbsp;0x10,&nbsp;0xff,&nbsp;0xf3,&nbsp;0xd2,&nbsp;0xcd,&nbsp;0x0c,<br>
0x13,&nbsp;0xec,&nbsp;0x5f,&nbsp;0x97,&nbsp;0x44,&nbsp;0x17,&nbsp;0xc4,&nbsp;0xa7,&nbsp;0x7e,&nbsp;0x3d,&nbsp;0x64,&nbsp;0x5d,&nbsp;0x19,<br>
0x73,&nbsp;0x60,&nbsp;0x81,&nbsp;0x4f,&nbsp;0xdc,&nbsp;0x22,&nbsp;0x2a,&nbsp;0x90,&nbsp;0x88,&nbsp;0x46,&nbsp;0xee,&nbsp;0xb8,&nbsp;0x14,<br>
0xde,&nbsp;0x5e,&nbsp;0x0b,&nbsp;0xdb,&nbsp;0xe0,&nbsp;0x32,&nbsp;0x3a,&nbsp;0x0a,&nbsp;0x49,&nbsp;0x06,&nbsp;0x24,&nbsp;0x5c,&nbsp;0xc2,<br>
0xd3,&nbsp;0xac,&nbsp;0x62,&nbsp;0x91,&nbsp;0x95,&nbsp;0xe4,&nbsp;0x79,&nbsp;0xe7,&nbsp;0xc8,&nbsp;0x37,&nbsp;0x6d,&nbsp;0x8d,&nbsp;0xd5,<br>
0x4e,&nbsp;0xa9,&nbsp;0x6c,&nbsp;0x56,&nbsp;0xf4,&nbsp;0xea,&nbsp;0x65,&nbsp;0x7a,&nbsp;0xae,&nbsp;0x08,&nbsp;0xba,&nbsp;0x78,&nbsp;0x25,<br>
0x2e,&nbsp;0x1c,&nbsp;0xa6,&nbsp;0xb4,&nbsp;0xc6,&nbsp;0xe8,&nbsp;0xdd,&nbsp;0x74,&nbsp;0x1f,&nbsp;0x4b,&nbsp;0xbd,&nbsp;0x8b,&nbsp;0x8a,<br>
0x70,&nbsp;0x3e,&nbsp;0xb5,&nbsp;0x66,&nbsp;0x48,&nbsp;0x03,&nbsp;0xf6,&nbsp;0x0e,&nbsp;0x61,&nbsp;0x35,&nbsp;0x57,&nbsp;0xb9,&nbsp;0x86,<br>
0xc1,&nbsp;0x1d,&nbsp;0x9e,&nbsp;0xe1,&nbsp;0xf8,&nbsp;0x98,&nbsp;0x11,&nbsp;0x69,&nbsp;0xd9,&nbsp;0x8e,&nbsp;0x94,&nbsp;0x9b,&nbsp;0x1e,<br>
0x87,&nbsp;0xe9,&nbsp;0xce,&nbsp;0x55,&nbsp;0x28,&nbsp;0xdf,&nbsp;0x8c,&nbsp;0xa1,&nbsp;0x89,&nbsp;0x0d,&nbsp;0xbf,&nbsp;0xe6,&nbsp;0x42,<br>
0x68,&nbsp;0x41,&nbsp;0x99,&nbsp;0x2d,&nbsp;0x0f,&nbsp;0xb0,&nbsp;0x54,&nbsp;0xbb,&nbsp;0x16<br>
]<br>
<br>
let&nbsp;aes_sbox_inv_table&nbsp;:&nbsp;vector(256,&nbsp;bits(8))&nbsp;=&nbsp;[<br>
0x52,&nbsp;0x09,&nbsp;0x6a,&nbsp;0xd5,&nbsp;0x30,&nbsp;0x36,&nbsp;0xa5,&nbsp;0x38,&nbsp;0xbf,&nbsp;0x40,&nbsp;0xa3,&nbsp;0x9e,&nbsp;0x81,<br>
0xf3,&nbsp;0xd7,&nbsp;0xfb,&nbsp;0x7c,&nbsp;0xe3,&nbsp;0x39,&nbsp;0x82,&nbsp;0x9b,&nbsp;0x2f,&nbsp;0xff,&nbsp;0x87,&nbsp;0x34,&nbsp;0x8e,<br>
0x43,&nbsp;0x44,&nbsp;0xc4,&nbsp;0xde,&nbsp;0xe9,&nbsp;0xcb,&nbsp;0x54,&nbsp;0x7b,&nbsp;0x94,&nbsp;0x32,&nbsp;0xa6,&nbsp;0xc2,&nbsp;0x23,<br>
0x3d,&nbsp;0xee,&nbsp;0x4c,&nbsp;0x95,&nbsp;0x0b,&nbsp;0x42,&nbsp;0xfa,&nbsp;0xc3,&nbsp;0x4e,&nbsp;0x08,&nbsp;0x2e,&nbsp;0xa1,&nbsp;0x66,<br>
0x28,&nbsp;0xd9,&nbsp;0x24,&nbsp;0xb2,&nbsp;0x76,&nbsp;0x5b,&nbsp;0xa2,&nbsp;0x49,&nbsp;0x6d,&nbsp;0x8b,&nbsp;0xd1,&nbsp;0x25,&nbsp;0x72,<br>
0xf8,&nbsp;0xf6,&nbsp;0x64,&nbsp;0x86,&nbsp;0x68,&nbsp;0x98,&nbsp;0x16,&nbsp;0xd4,&nbsp;0xa4,&nbsp;0x5c,&nbsp;0xcc,&nbsp;0x5d,&nbsp;0x65,<br>
0xb6,&nbsp;0x92,&nbsp;0x6c,&nbsp;0x70,&nbsp;0x48,&nbsp;0x50,&nbsp;0xfd,&nbsp;0xed,&nbsp;0xb9,&nbsp;0xda,&nbsp;0x5e,&nbsp;0x15,&nbsp;0x46,<br>
0x57,&nbsp;0xa7,&nbsp;0x8d,&nbsp;0x9d,&nbsp;0x84,&nbsp;0x90,&nbsp;0xd8,&nbsp;0xab,&nbsp;0x00,&nbsp;0x8c,&nbsp;0xbc,&nbsp;0xd3,&nbsp;0x0a,<br>
0xf7,&nbsp;0xe4,&nbsp;0x58,&nbsp;0x05,&nbsp;0xb8,&nbsp;0xb3,&nbsp;0x45,&nbsp;0x06,&nbsp;0xd0,&nbsp;0x2c,&nbsp;0x1e,&nbsp;0x8f,&nbsp;0xca,<br>
0x3f,&nbsp;0x0f,&nbsp;0x02,&nbsp;0xc1,&nbsp;0xaf,&nbsp;0xbd,&nbsp;0x03,&nbsp;0x01,&nbsp;0x13,&nbsp;0x8a,&nbsp;0x6b,&nbsp;0x3a,&nbsp;0x91,<br>
0x11,&nbsp;0x41,&nbsp;0x4f,&nbsp;0x67,&nbsp;0xdc,&nbsp;0xea,&nbsp;0x97,&nbsp;0xf2,&nbsp;0xcf,&nbsp;0xce,&nbsp;0xf0,&nbsp;0xb4,&nbsp;0xe6,<br>
0x73,&nbsp;0x96,&nbsp;0xac,&nbsp;0x74,&nbsp;0x22,&nbsp;0xe7,&nbsp;0xad,&nbsp;0x35,&nbsp;0x85,&nbsp;0xe2,&nbsp;0xf9,&nbsp;0x37,&nbsp;0xe8,<br>
0x1c,&nbsp;0x75,&nbsp;0xdf,&nbsp;0x6e,&nbsp;0x47,&nbsp;0xf1,&nbsp;0x1a,&nbsp;0x71,&nbsp;0x1d,&nbsp;0x29,&nbsp;0xc5,&nbsp;0x89,&nbsp;0x6f,<br>
0xb7,&nbsp;0x62,&nbsp;0x0e,&nbsp;0xaa,&nbsp;0x18,&nbsp;0xbe,&nbsp;0x1b,&nbsp;0xfc,&nbsp;0x56,&nbsp;0x3e,&nbsp;0x4b,&nbsp;0xc6,&nbsp;0xd2,<br>
0x79,&nbsp;0x20,&nbsp;0x9a,&nbsp;0xdb,&nbsp;0xc0,&nbsp;0xfe,&nbsp;0x78,&nbsp;0xcd,&nbsp;0x5a,&nbsp;0xf4,&nbsp;0x1f,&nbsp;0xdd,&nbsp;0xa8,<br>
0x33,&nbsp;0x88,&nbsp;0x07,&nbsp;0xc7,&nbsp;0x31,&nbsp;0xb1,&nbsp;0x12,&nbsp;0x10,&nbsp;0x59,&nbsp;0x27,&nbsp;0x80,&nbsp;0xec,&nbsp;0x5f,<br>
0x60,&nbsp;0x51,&nbsp;0x7f,&nbsp;0xa9,&nbsp;0x19,&nbsp;0xb5,&nbsp;0x4a,&nbsp;0x0d,&nbsp;0x2d,&nbsp;0xe5,&nbsp;0x7a,&nbsp;0x9f,&nbsp;0x93,<br>
0xc9,&nbsp;0x9c,&nbsp;0xef,&nbsp;0xa0,&nbsp;0xe0,&nbsp;0x3b,&nbsp;0x4d,&nbsp;0xae,&nbsp;0x2a,&nbsp;0xf5,&nbsp;0xb0,&nbsp;0xc8,&nbsp;0xeb,<br>
0xbb,&nbsp;0x3c,&nbsp;0x83,&nbsp;0x53,&nbsp;0x99,&nbsp;0x61,&nbsp;0x17,&nbsp;0x2b,&nbsp;0x04,&nbsp;0x7e,&nbsp;0xba,&nbsp;0x77,&nbsp;0xd6,<br>
0x26,&nbsp;0xe1,&nbsp;0x69,&nbsp;0x14,&nbsp;0x63,&nbsp;0x55,&nbsp;0x21,&nbsp;0x0c,&nbsp;0x7d<br>
]<br>
<br>
/*&nbsp;Lookup&nbsp;function&nbsp;-&nbsp;takes&nbsp;an&nbsp;index&nbsp;and&nbsp;a&nbsp;table,&nbsp;and&nbsp;retrieves&nbsp;the<br>
&nbsp;*&nbsp;x'th&nbsp;element&nbsp;of&nbsp;that&nbsp;table.&nbsp;Note&nbsp;that&nbsp;the&nbsp;Sail&nbsp;vector&nbsp;literals<br>
&nbsp;*&nbsp;start&nbsp;at&nbsp;index&nbsp;255,&nbsp;and&nbsp;go&nbsp;down&nbsp;to&nbsp;0.<br>
&nbsp;*/<br>
val&nbsp;sbox_lookup&nbsp;:&nbsp;(bits(8),&nbsp;vector(256,&nbsp;bits(8)))&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;sbox_lookup(x,&nbsp;table)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;table[255&nbsp;-&nbsp;unsigned(x)]<br>
}</span><br>
<br>
/*&nbsp;Easy&nbsp;function&nbsp;to&nbsp;perform&nbsp;a&nbsp;forward&nbsp;AES&nbsp;SBox&nbsp;operation&nbsp;on&nbsp;1&nbsp;byte.&nbsp;*/<br>
val&nbsp;aes_sbox_fwd&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;aes_sbox_fwd(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">sbox_lookup(x,&nbsp;aes_sbox_fwd_table)</span><br>
<br>
/*&nbsp;Easy&nbsp;function&nbsp;to&nbsp;perform&nbsp;an&nbsp;inverse&nbsp;AES&nbsp;SBox&nbsp;operation&nbsp;on&nbsp;1&nbsp;byte.&nbsp;*/<br>
val&nbsp;aes_sbox_inv&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;aes_sbox_inv(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">sbox_lookup(x,&nbsp;aes_sbox_inv_table)</span><br>
<br>
/*&nbsp;AES&nbsp;SubWord&nbsp;function&nbsp;used&nbsp;in&nbsp;the&nbsp;key&nbsp;expansion<br>
&nbsp;*&nbsp;-&nbsp;Applies&nbsp;the&nbsp;forward&nbsp;sbox&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;the&nbsp;input&nbsp;word.<br>
&nbsp;*/<br>
val&nbsp;aes_subword_fwd&nbsp;:&nbsp;bits(32)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_subword_fwd(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;aes_sbox_fwd(x[31..24])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[23..16])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[15..&nbsp;8])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[&nbsp;7..&nbsp;0])<br>
}</span><br>
<br>
/*&nbsp;AES&nbsp;Inverse&nbsp;SubWord&nbsp;function.<br>
&nbsp;*&nbsp;-&nbsp;Applies&nbsp;the&nbsp;inverse&nbsp;sbox&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;the&nbsp;input&nbsp;word.<br>
&nbsp;*/<br>
val&nbsp;aes_subword_inv&nbsp;:&nbsp;bits(32)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_subword_inv(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;aes_sbox_inv(x[31..24])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[23..16])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[15..&nbsp;8])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[&nbsp;7..&nbsp;0])<br>
}<br>
<br>
/*&nbsp;Easy&nbsp;function&nbsp;to&nbsp;perform&nbsp;an&nbsp;SM4&nbsp;SBox&nbsp;operation&nbsp;on&nbsp;1&nbsp;byte.&nbsp;*/<br>
val&nbsp;sm4_sbox&nbsp;:&nbsp;bits(8)&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;sm4_sbox(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">sbox_lookup(x,&nbsp;sm4_sbox_table)</span><br>
<br>
val&nbsp;aes_get_column&nbsp;:&nbsp;(bits(128),&nbsp;nat)&nbsp;-&gt;&nbsp;bits(32)<br>
function&nbsp;aes_get_column(state,c)&nbsp;=&nbsp;(state&nbsp;&gt;&gt;&nbsp;(to_bits(7,&nbsp;32&nbsp;*&nbsp;c)))[31..0]<br>
<br>
/*&nbsp;64-bit&nbsp;to&nbsp;64-bit&nbsp;function&nbsp;which&nbsp;applies&nbsp;the&nbsp;AES&nbsp;forward&nbsp;sbox&nbsp;to&nbsp;each&nbsp;byte<br>
&nbsp;*&nbsp;in&nbsp;a&nbsp;64-bit&nbsp;word.<br>
&nbsp;*/<br>
val&nbsp;aes_apply_fwd_sbox_to_each_byte&nbsp;:&nbsp;bits(64)&nbsp;-&gt;&nbsp;bits(64)<br>
function&nbsp;aes_apply_fwd_sbox_to_each_byte(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;aes_sbox_fwd(x[63..56])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[55..48])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[47..40])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[39..32])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[31..24])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[23..16])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[15..&nbsp;8])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_fwd(x[&nbsp;7..&nbsp;0])<br>
}</span><br>
<br>
/*&nbsp;64-bit&nbsp;to&nbsp;64-bit&nbsp;function&nbsp;which&nbsp;applies&nbsp;the&nbsp;AES&nbsp;inverse&nbsp;sbox&nbsp;to&nbsp;each&nbsp;byte<br>
&nbsp;*&nbsp;in&nbsp;a&nbsp;64-bit&nbsp;word.<br>
&nbsp;*/<br>
val&nbsp;aes_apply_inv_sbox_to_each_byte&nbsp;:&nbsp;bits(64)&nbsp;-&gt;&nbsp;bits(64)<br>
function&nbsp;aes_apply_inv_sbox_to_each_byte(x)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;aes_sbox_inv(x[63..56])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[55..48])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[47..40])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[39..32])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[31..24])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[23..16])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[15..&nbsp;8])&nbsp;@<br>
&nbsp;&nbsp;aes_sbox_inv(x[&nbsp;7..&nbsp;0])<br>
}</span><br>
<br>
/*<br>
&nbsp;*&nbsp;AES&nbsp;full-round&nbsp;transformation&nbsp;functions.<br>
&nbsp;*/<br>
<br>
val&nbsp;getbyte&nbsp;:&nbsp;(bits(64),&nbsp;int)&nbsp;-&gt;&nbsp;bits(8)<br>
function&nbsp;getbyte(x,&nbsp;i)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">(x&nbsp;&gt;&gt;&nbsp;to_bits(6,&nbsp;i&nbsp;*&nbsp;8))[7..0]</span><br>
<br>
val&nbsp;aes_rv64_shiftrows_fwd&nbsp;:&nbsp;(bits(64),&nbsp;bits(64))&nbsp;-&gt;&nbsp;bits(64)<br>
function&nbsp;aes_rv64_shiftrows_fwd(rs2,&nbsp;rs1)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;3)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;6)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;1)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;4)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;7)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;2)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;5)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;0)<br>
}</span><br>
<br>
val&nbsp;aes_rv64_shiftrows_inv&nbsp;:&nbsp;(bits(64),&nbsp;bits(64))&nbsp;-&gt;&nbsp;bits(64)<br>
function&nbsp;aes_rv64_shiftrows_inv(rs2,&nbsp;rs1)&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;3)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;6)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;1)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;4)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;7)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;2)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs2,&nbsp;5)&nbsp;@<br>
&nbsp;&nbsp;getbyte(rs1,&nbsp;0)<br>
}</span><br>
<br>
/*&nbsp;128-bit&nbsp;to&nbsp;128-bit&nbsp;implementation&nbsp;of&nbsp;the&nbsp;forward&nbsp;AES&nbsp;ShiftRows&nbsp;transform.<br>
&nbsp;*&nbsp;Byte&nbsp;0&nbsp;of&nbsp;state&nbsp;is&nbsp;input&nbsp;column&nbsp;0,&nbsp;bits&nbsp;&nbsp;7..0.<br>
&nbsp;*&nbsp;Byte&nbsp;5&nbsp;of&nbsp;state&nbsp;is&nbsp;input&nbsp;column&nbsp;1,&nbsp;bits&nbsp;15..8.<br>
&nbsp;*/<br>
val&nbsp;aes_shift_rows_fwd&nbsp;:&nbsp;bits(128)&nbsp;-&gt;&nbsp;bits(128)<br>
function&nbsp;aes_shift_rows_fwd(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;ic3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;3);<br>
&nbsp;&nbsp;let&nbsp;ic2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;2);<br>
&nbsp;&nbsp;let&nbsp;ic1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;1);<br>
&nbsp;&nbsp;let&nbsp;ic0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;0);<br>
&nbsp;&nbsp;let&nbsp;oc0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic0[31..24]&nbsp;@&nbsp;ic1[23..16]&nbsp;@&nbsp;ic2[15..&nbsp;8]&nbsp;@&nbsp;ic3[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;oc1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic1[31..24]&nbsp;@&nbsp;ic2[23..16]&nbsp;@&nbsp;ic3[15..&nbsp;8]&nbsp;@&nbsp;ic0[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;oc2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic2[31..24]&nbsp;@&nbsp;ic3[23..16]&nbsp;@&nbsp;ic0[15..&nbsp;8]&nbsp;@&nbsp;ic1[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;oc3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic3[31..24]&nbsp;@&nbsp;ic0[23..16]&nbsp;@&nbsp;ic1[15..&nbsp;8]&nbsp;@&nbsp;ic2[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;(oc3&nbsp;@&nbsp;oc2&nbsp;@&nbsp;oc1&nbsp;@&nbsp;oc0)&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}<br>
<br>
/*&nbsp;128-bit&nbsp;to&nbsp;128-bit&nbsp;implementation&nbsp;of&nbsp;the&nbsp;inverse&nbsp;AES&nbsp;ShiftRows&nbsp;transform.<br>
&nbsp;*&nbsp;Byte&nbsp;0&nbsp;of&nbsp;state&nbsp;is&nbsp;input&nbsp;column&nbsp;0,&nbsp;bits&nbsp;&nbsp;7..0.<br>
&nbsp;*&nbsp;Byte&nbsp;5&nbsp;of&nbsp;state&nbsp;is&nbsp;input&nbsp;column&nbsp;1,&nbsp;bits&nbsp;15..8.<br>
&nbsp;*/<br>
val&nbsp;aes_shift_rows_inv&nbsp;:&nbsp;bits(128)&nbsp;-&gt;&nbsp;bits(128)<br>
function&nbsp;aes_shift_rows_inv(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;ic3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;3);&nbsp;/*&nbsp;In&nbsp;column&nbsp;3&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;ic2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;2);<br>
&nbsp;&nbsp;let&nbsp;ic1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;1);<br>
&nbsp;&nbsp;let&nbsp;ic0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_get_column(x,&nbsp;0);<br>
&nbsp;&nbsp;let&nbsp;oc0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic0[31..24]&nbsp;@&nbsp;ic3[23..16]&nbsp;@&nbsp;ic2[15..&nbsp;8]&nbsp;@&nbsp;ic1[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;oc1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic1[31..24]&nbsp;@&nbsp;ic0[23..16]&nbsp;@&nbsp;ic3[15..&nbsp;8]&nbsp;@&nbsp;ic2[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;oc2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic2[31..24]&nbsp;@&nbsp;ic1[23..16]&nbsp;@&nbsp;ic0[15..&nbsp;8]&nbsp;@&nbsp;ic3[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;let&nbsp;oc3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;ic3[31..24]&nbsp;@&nbsp;ic2[23..16]&nbsp;@&nbsp;ic1[15..&nbsp;8]&nbsp;@&nbsp;ic0[&nbsp;7..&nbsp;0];<br>
&nbsp;&nbsp;(oc3&nbsp;@&nbsp;oc2&nbsp;@&nbsp;oc1&nbsp;@&nbsp;oc0)&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}<br>
<br>
/*&nbsp;Applies&nbsp;the&nbsp;forward&nbsp;sub-bytes&nbsp;step&nbsp;of&nbsp;AES&nbsp;to&nbsp;a&nbsp;128-bit&nbsp;vector<br>
&nbsp;*&nbsp;representation&nbsp;of&nbsp;its&nbsp;state.<br>
&nbsp;*/<br>
val&nbsp;aes_subbytes_fwd&nbsp;:&nbsp;bits(128)&nbsp;-&gt;&nbsp;bits(128)<br>
function&nbsp;aes_subbytes_fwd(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;oc0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_fwd(aes_get_column(x,&nbsp;0));<br>
&nbsp;&nbsp;let&nbsp;oc1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_fwd(aes_get_column(x,&nbsp;1));<br>
&nbsp;&nbsp;let&nbsp;oc2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_fwd(aes_get_column(x,&nbsp;2));<br>
&nbsp;&nbsp;let&nbsp;oc3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_fwd(aes_get_column(x,&nbsp;3));<br>
&nbsp;&nbsp;(oc3&nbsp;@&nbsp;oc2&nbsp;@&nbsp;oc1&nbsp;@&nbsp;oc0)&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}<br>
<br>
/*&nbsp;Applies&nbsp;the&nbsp;inverse&nbsp;sub-bytes&nbsp;step&nbsp;of&nbsp;AES&nbsp;to&nbsp;a&nbsp;128-bit&nbsp;vector<br>
&nbsp;*&nbsp;representation&nbsp;of&nbsp;its&nbsp;state.<br>
&nbsp;*/<br>
val&nbsp;aes_subbytes_inv&nbsp;:&nbsp;bits(128)&nbsp;-&gt;&nbsp;bits(128)<br>
function&nbsp;aes_subbytes_inv(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;oc0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_inv(aes_get_column(x,&nbsp;0));<br>
&nbsp;&nbsp;let&nbsp;oc1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_inv(aes_get_column(x,&nbsp;1));<br>
&nbsp;&nbsp;let&nbsp;oc2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_inv(aes_get_column(x,&nbsp;2));<br>
&nbsp;&nbsp;let&nbsp;oc3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_subword_inv(aes_get_column(x,&nbsp;3));<br>
&nbsp;&nbsp;(oc3&nbsp;@&nbsp;oc2&nbsp;@&nbsp;oc1&nbsp;@&nbsp;oc0)&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}<br>
<br>
/*&nbsp;Applies&nbsp;the&nbsp;forward&nbsp;MixColumns&nbsp;step&nbsp;of&nbsp;AES&nbsp;to&nbsp;a&nbsp;128-bit&nbsp;vector<br>
&nbsp;*&nbsp;representation&nbsp;of&nbsp;its&nbsp;state.<br>
&nbsp;*/<br>
val&nbsp;aes_mixcolumns_fwd&nbsp;:&nbsp;bits(128)&nbsp;-&gt;&nbsp;bits(128)<br>
function&nbsp;aes_mixcolumns_fwd(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;oc0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_fwd(aes_get_column(x,&nbsp;0));<br>
&nbsp;&nbsp;let&nbsp;oc1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_fwd(aes_get_column(x,&nbsp;1));<br>
&nbsp;&nbsp;let&nbsp;oc2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_fwd(aes_get_column(x,&nbsp;2));<br>
&nbsp;&nbsp;let&nbsp;oc3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_fwd(aes_get_column(x,&nbsp;3));<br>
&nbsp;&nbsp;(oc3&nbsp;@&nbsp;oc2&nbsp;@&nbsp;oc1&nbsp;@&nbsp;oc0)&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}<br>
<br>
/*&nbsp;Applies&nbsp;the&nbsp;inverse&nbsp;MixColumns&nbsp;step&nbsp;of&nbsp;AES&nbsp;to&nbsp;a&nbsp;128-bit&nbsp;vector<br>
&nbsp;*&nbsp;representation&nbsp;of&nbsp;its&nbsp;state.<br>
&nbsp;*/<br>
val&nbsp;aes_mixcolumns_inv&nbsp;:&nbsp;bits(128)&nbsp;-&gt;&nbsp;bits(128)<br>
function&nbsp;aes_mixcolumns_inv(x)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;oc0&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_inv(aes_get_column(x,&nbsp;0));<br>
&nbsp;&nbsp;let&nbsp;oc1&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_inv(aes_get_column(x,&nbsp;1));<br>
&nbsp;&nbsp;let&nbsp;oc2&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_inv(aes_get_column(x,&nbsp;2));<br>
&nbsp;&nbsp;let&nbsp;oc3&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;aes_mixcolumn_inv(aes_get_column(x,&nbsp;3));<br>
&nbsp;&nbsp;(oc3&nbsp;@&nbsp;oc2&nbsp;@&nbsp;oc1&nbsp;@&nbsp;oc0)&nbsp;/*&nbsp;Return&nbsp;value&nbsp;*/<br>
}<br>
</code>
</body>
</html>
