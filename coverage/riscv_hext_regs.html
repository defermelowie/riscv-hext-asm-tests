<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>riscv_hext_regs</title></head>
<body>
<h1>riscv_hext_regs.sail (22/27) 81%</h1>
<code style="display: block">
/*=======================================================================================*/<br>
/*&nbsp;&nbsp;RISCV&nbsp;Sail&nbsp;Model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;Sail&nbsp;RISC-V&nbsp;architecture&nbsp;model,&nbsp;comprising&nbsp;all&nbsp;files&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;directories&nbsp;except&nbsp;for&nbsp;the&nbsp;snapshots&nbsp;of&nbsp;the&nbsp;Lem&nbsp;and&nbsp;Sail&nbsp;libraries&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;in&nbsp;the&nbsp;prover_snapshots&nbsp;directory&nbsp;(which&nbsp;include&nbsp;copies&nbsp;of&nbsp;their&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;licences),&nbsp;is&nbsp;subject&nbsp;to&nbsp;the&nbsp;BSD&nbsp;two-clause&nbsp;licence&nbsp;below.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Copyright&nbsp;(c)&nbsp;2017-2023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Prashanth&nbsp;Mundkur&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Rishiyur&nbsp;S.&nbsp;Nikhil&nbsp;and&nbsp;Bluespec,&nbsp;Inc.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Jon&nbsp;French&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Brian&nbsp;Campbell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Robert&nbsp;Norton-Wright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Alasdair&nbsp;Armstrong&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Thomas&nbsp;Bauereiss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Shaked&nbsp;Flur&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Christopher&nbsp;Pulte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Peter&nbsp;Sewell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Alexander&nbsp;Richardson&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Hesham&nbsp;Almatary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Jessica&nbsp;Clarke&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Microsoft,&nbsp;for&nbsp;contributions&nbsp;by&nbsp;Robert&nbsp;Norton-Wright&nbsp;and&nbsp;Nathaniel&nbsp;Wesley&nbsp;Filardo&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Peter&nbsp;Rugg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Aril&nbsp;Computer&nbsp;Corp.,&nbsp;for&nbsp;contributions&nbsp;by&nbsp;Scott&nbsp;Johnson&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Philipp&nbsp;Tomsich&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;VRULL&nbsp;GmbH,&nbsp;for&nbsp;contributions&nbsp;by&nbsp;its&nbsp;employees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;software&nbsp;was&nbsp;developed&nbsp;by&nbsp;the&nbsp;above&nbsp;within&nbsp;the&nbsp;Rigorous&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Engineering&nbsp;of&nbsp;Mainstream&nbsp;Systems&nbsp;(REMS)&nbsp;project,&nbsp;partly&nbsp;funded&nbsp;by&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;EPSRC&nbsp;grant&nbsp;EP/K008528/1,&nbsp;at&nbsp;the&nbsp;Universities&nbsp;of&nbsp;Cambridge&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Edinburgh.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;software&nbsp;was&nbsp;developed&nbsp;by&nbsp;SRI&nbsp;International&nbsp;and&nbsp;the&nbsp;University&nbsp;of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Cambridge&nbsp;Computer&nbsp;Laboratory&nbsp;(Department&nbsp;of&nbsp;Computer&nbsp;Science&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Technology)&nbsp;under&nbsp;DARPA/AFRL&nbsp;contract&nbsp;FA8650-18-C-7809&nbsp;(&quot;CIFV&quot;),&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;under&nbsp;DARPA&nbsp;contract&nbsp;HR0011-18-C-0016&nbsp;(&quot;ECATS&quot;)&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;DARPA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SSITH&nbsp;research&nbsp;programme.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;This&nbsp;project&nbsp;has&nbsp;received&nbsp;funding&nbsp;from&nbsp;the&nbsp;European&nbsp;Research&nbsp;Council&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;(ERC)&nbsp;under&nbsp;the&nbsp;European&nbsp;Union’s&nbsp;Horizon&nbsp;2020&nbsp;research&nbsp;and&nbsp;innovation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;programme&nbsp;(grant&nbsp;agreement&nbsp;789108,&nbsp;ELVER).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Redistribution&nbsp;and&nbsp;use&nbsp;in&nbsp;source&nbsp;and&nbsp;binary&nbsp;forms,&nbsp;with&nbsp;or&nbsp;without&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;modification,&nbsp;are&nbsp;permitted&nbsp;provided&nbsp;that&nbsp;the&nbsp;following&nbsp;conditions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;are&nbsp;met:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;1.&nbsp;Redistributions&nbsp;of&nbsp;source&nbsp;code&nbsp;must&nbsp;retain&nbsp;the&nbsp;above&nbsp;copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;2.&nbsp;Redistributions&nbsp;in&nbsp;binary&nbsp;form&nbsp;must&nbsp;reproduce&nbsp;the&nbsp;above&nbsp;copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer&nbsp;in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;documentation&nbsp;and/or&nbsp;other&nbsp;materials&nbsp;provided&nbsp;with&nbsp;the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribution.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHOR&nbsp;AND&nbsp;CONTRIBUTORS&nbsp;``AS&nbsp;IS''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS&nbsp;OR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;TO,&nbsp;THE&nbsp;IMPLIED&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;PARTICULAR&nbsp;PURPOSE&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHOR&nbsp;OR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;CONTRIBUTORS&nbsp;BE&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,&nbsp;EVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SUCH&nbsp;DAMAGE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*=======================================================================================*/<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtualization&nbsp;Mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;cur_virtualization&nbsp;:&nbsp;Virtualization<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;Status&nbsp;Register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
bitfield&nbsp;Hstatus&nbsp;:&nbsp;xlenbits&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;/*&nbsp;VSXL&nbsp;only&nbsp;exists&nbsp;if&nbsp;HSXLEN&nbsp;==&nbsp;64&nbsp;so&nbsp;it's&nbsp;modelled&nbsp;via&nbsp;explicit&nbsp;an&nbsp;getter&nbsp;and&nbsp;setter&nbsp;below.*/<br>
&nbsp;&nbsp;/*&nbsp;VSXL&nbsp;:&nbsp;33&nbsp;..&nbsp;32&nbsp;*/<br>
&nbsp;&nbsp;VTSR&nbsp;&nbsp;:&nbsp;22,<br>
&nbsp;&nbsp;VTW&nbsp;&nbsp;&nbsp;:&nbsp;21,<br>
&nbsp;&nbsp;VTVM&nbsp;&nbsp;:&nbsp;20,<br>
&nbsp;&nbsp;VGEIN&nbsp;:&nbsp;17&nbsp;..&nbsp;12,<br>
&nbsp;&nbsp;HU&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;9,<br>
&nbsp;&nbsp;SPVP&nbsp;&nbsp;:&nbsp;8,<br>
&nbsp;&nbsp;SPV&nbsp;&nbsp;&nbsp;:&nbsp;7,<br>
&nbsp;&nbsp;GVA&nbsp;&nbsp;&nbsp;:&nbsp;6,<br>
&nbsp;&nbsp;VSBE&nbsp;&nbsp;:&nbsp;5<br>
}<br>
register&nbsp;hstatus&nbsp;:&nbsp;Hstatus<br>
<br>
function&nbsp;get_hstatus_VSXL(h&nbsp;:&nbsp;Hstatus)&nbsp;-&gt;&nbsp;arch_xlen&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;if&nbsp;sizeof(xlen)&nbsp;==&nbsp;32<br>
&nbsp;&nbsp;then&nbsp;arch_to_bits(RV32)<br>
&nbsp;&nbsp;else&nbsp;h.bits()[33&nbsp;..&nbsp;32]<br>
}</span><br>
<br>
function&nbsp;set_hstatus_VSXL(h&nbsp;:&nbsp;Hstatus,&nbsp;a&nbsp;:&nbsp;arch_xlen)&nbsp;-&gt;&nbsp;Hstatus&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;if&nbsp;sizeof(xlen)&nbsp;==&nbsp;32<br>
&nbsp;&nbsp;then&nbsp;h<br>
&nbsp;&nbsp;else&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;vector_update_subrange(h.bits(),&nbsp;33,&nbsp;32,&nbsp;a);<br>
&nbsp;&nbsp;&nbsp;&nbsp;Mk_Hstatus(h)<br>
&nbsp;&nbsp;}<br>
}</span><br>
<br>
function&nbsp;legalize_hstatus(o&nbsp;:&nbsp;Hstatus,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Hstatus&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Hstatus(v);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Hstatus(zero_extend(0b0));<br>
<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VTSR(h,&nbsp;v.VTSR());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VTW(h,&nbsp;v.VTW());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VTVM(h,&nbsp;v.VTVM());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VGEIN(h,&nbsp;v.VGEIN());&nbsp;&nbsp;/*&nbsp;Note:&nbsp;0&nbsp;&lt;=&nbsp;hstatus.VGEIN&nbsp;&lt;=&nbsp;GEILEN&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_HU(h,&nbsp;v.HU());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_SPVP(h,&nbsp;v.SPVP());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_SPV(h,&nbsp;v.SPV());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_GVA(h,&nbsp;v.GVA());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSBE(h,&nbsp;v.VSBE());<br>
<br>
&nbsp;&nbsp;/*&nbsp;Dynamic&nbsp;XLEN&nbsp;changes&nbsp;are&nbsp;not&nbsp;(yet)&nbsp;supported&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;set_hstatus_VSXL(h,&nbsp;get_hstatus_VSXL(o));<br>
<br>
&nbsp;&nbsp;h<br>
}</span><br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;Trap&nbsp;Delegation&nbsp;Registers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;hedeleg&nbsp;:&nbsp;Medeleg<br>
<br>
function&nbsp;legalize_hedeleg(o:&nbsp;Medeleg,&nbsp;v:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Medeleg&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Medeleg(v);<br>
&nbsp;&nbsp;/*&nbsp;Mask&nbsp;read-only&nbsp;zero&nbsp;bits&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_SAMO_GPage_Fault(h,&nbsp;0b0);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_Virtual_Instr(h,&nbsp;0b0);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_Load_GPage_Fault(h,&nbsp;0b0);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_Fetch_GPage_Fault(h,&nbsp;0b0);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_MEnvCall(h,&nbsp;0b0);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSEnvCall(h,&nbsp;0b0);<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_HSEnvCall(h,&nbsp;0b0);<br>
&nbsp;&nbsp;h<br>
}</span><br>
<br>
register&nbsp;hideleg&nbsp;:&nbsp;Minterrupts&nbsp;/*&nbsp;Delegation&nbsp;to&nbsp;VS-mode&nbsp;*/<br>
<br>
function&nbsp;legalize_hideleg(h&nbsp;:&nbsp;Minterrupts,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Minterrupts(v);<br>
&nbsp;&nbsp;/*&nbsp;VS-level&nbsp;interrupts&nbsp;can&nbsp;be&nbsp;delegated&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSEI(h,&nbsp;v.VSEI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSTI(h,&nbsp;v.VSTI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSSI(h,&nbsp;v.VSSI());<br>
&nbsp;&nbsp;/*&nbsp;Other&nbsp;interrupts&nbsp;can't&nbsp;be&nbsp;delegated&nbsp;to&nbsp;VS-mode&nbsp;*/<br>
&nbsp;&nbsp;h<br>
}</span><br>
<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;Interrupt&nbsp;enable/pending&nbsp;registers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
/*&nbsp;hvip&nbsp;is&nbsp;a&nbsp;view&nbsp;of&nbsp;mip,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;register&nbsp;defined.&nbsp;*/<br>
<br>
/*!&nbsp;Returns&nbsp;new&nbsp;mip&nbsp;from&nbsp;the&nbsp;previous&nbsp;mip&nbsp;(m)&nbsp;and&nbsp;the&nbsp;written&nbsp;hvip&nbsp;(v)&nbsp;*/<br>
function&nbsp;legalize_hvip(m:&nbsp;Minterrupts,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Minterrupts(v);<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSEI(m,&nbsp;v.VSEI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSTI(m,&nbsp;v.VSTI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSSI(m,&nbsp;v.VSSI());<br>
&nbsp;&nbsp;//&nbsp;TODO:&nbsp;Update&nbsp;non-standard&nbsp;portion<br>
&nbsp;&nbsp;m<br>
}</span><br>
<br>
/*!&nbsp;Returns&nbsp;hvip&nbsp;view&nbsp;of&nbsp;mip&nbsp;(m)&nbsp;*/<br>
function&nbsp;lower_mip_to_hvip(m&nbsp;:&nbsp;Minterrupts)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Minterrupts(zeros());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSEI(h,&nbsp;m.VSEI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSTI(h,&nbsp;m.VSTI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSSI(h,&nbsp;m.VSSI());<br>
&nbsp;&nbsp;//&nbsp;TODO:&nbsp;Read&nbsp;non-standard&nbsp;portion<br>
&nbsp;&nbsp;h<br>
}</span><br>
<br>
/*&nbsp;hip&nbsp;is&nbsp;a&nbsp;view&nbsp;of&nbsp;mip,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;register&nbsp;defined.&nbsp;*/<br>
<br>
/*!&nbsp;Returns&nbsp;new&nbsp;mip&nbsp;from&nbsp;the&nbsp;previous&nbsp;mip&nbsp;(m)&nbsp;and&nbsp;the&nbsp;written&nbsp;hip&nbsp;(v)&nbsp;*/<br>
function&nbsp;legalize_hip(m&nbsp;:&nbsp;Minterrupts,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Minterrupts(v);<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSSI(m,&nbsp;v.VSSI());<br>
&nbsp;&nbsp;//&nbsp;TODO:&nbsp;Update&nbsp;non-standard&nbsp;portion<br>
&nbsp;&nbsp;m<br>
}</span><br>
<br>
/*!&nbsp;Returns&nbsp;hip&nbsp;view&nbsp;of&nbsp;mip&nbsp;(m)&nbsp;*/<br>
function&nbsp;lower_mip_to_hip(m&nbsp;:&nbsp;Minterrupts)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Minterrupts(zeros());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_SGEI(h,&nbsp;m.SGEI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSEI(h,&nbsp;m.VSEI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSTI(h,&nbsp;m.VSTI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSSI(h,&nbsp;m.VSSI());<br>
&nbsp;&nbsp;//&nbsp;TODO:&nbsp;Read&nbsp;non-standard&nbsp;portion<br>
&nbsp;&nbsp;h<br>
}</span><br>
<br>
/*&nbsp;hie&nbsp;is&nbsp;a&nbsp;view&nbsp;of&nbsp;mie,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;register&nbsp;defined.&nbsp;*/<br>
<br>
/*!&nbsp;Returns&nbsp;new&nbsp;mie&nbsp;from&nbsp;the&nbsp;previous&nbsp;mie&nbsp;(m)&nbsp;and&nbsp;the&nbsp;written&nbsp;hie&nbsp;(v)&nbsp;*/<br>
function&nbsp;legalize_hie(m&nbsp;:&nbsp;Minterrupts,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Minterrupts(v);<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_SGEI(m,&nbsp;v.SGEI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSEI(m,&nbsp;v.VSEI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSTI(m,&nbsp;v.VSTI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSSI(m,&nbsp;v.VSSI());<br>
&nbsp;&nbsp;/*&nbsp;Note:&nbsp;Writable&nbsp;bits&nbsp;in&nbsp;sie&nbsp;are&nbsp;read-only&nbsp;zero&nbsp;in&nbsp;hie&nbsp;*/<br>
&nbsp;&nbsp;//&nbsp;TODO:&nbsp;Update&nbsp;non-standard&nbsp;portion<br>
&nbsp;&nbsp;m<br>
}</span><br>
<br>
/*!&nbsp;Returns&nbsp;hie&nbsp;view&nbsp;of&nbsp;mie&nbsp;*/<br>
function&nbsp;lower_mie_to_hie(m&nbsp;:&nbsp;Minterrupts)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Minterrupts(zeros());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_SGEI(h,&nbsp;m.SGEI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSEI(h,&nbsp;m.VSEI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSTI(h,&nbsp;m.VSTI());<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;update_VSSI(h,&nbsp;m.VSSI());<br>
&nbsp;&nbsp;/*&nbsp;Note:&nbsp;Writable&nbsp;bits&nbsp;in&nbsp;sie&nbsp;are&nbsp;read-only&nbsp;zero&nbsp;in&nbsp;hie&nbsp;*/<br>
&nbsp;&nbsp;//&nbsp;TODO:&nbsp;Read&nbsp;non-standard&nbsp;portion<br>
&nbsp;&nbsp;h<br>
}</span><br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;environment&nbsp;configuration&nbsp;register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;henvcfg&nbsp;:&nbsp;Envcfg<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;hpm-related&nbsp;registers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;hcounteren&nbsp;:&nbsp;Counteren<br>
<br>
function&nbsp;legalize_hcounteren(c&nbsp;:&nbsp;Counteren,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Counteren&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;legalize_counteren(c,&nbsp;v)<br>
}</span><br>
<br>
register&nbsp;htimedelta&nbsp;:&nbsp;bits(64)<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;Guest&nbsp;External&nbsp;Interrupts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;hgeie&nbsp;:&nbsp;xlenbits<br>
register&nbsp;hgeip&nbsp;:&nbsp;xlenbits<br>
//&nbsp;TODO:&nbsp;hgeip&nbsp;should&nbsp;be&nbsp;written&nbsp;by&nbsp;interrupt&nbsp;controller<br>
//&nbsp;TODO:&nbsp;hip.SGEI&nbsp;is&nbsp;1&nbsp;if&nbsp;bitwise&nbsp;and&nbsp;of&nbsp;hgeip&nbsp;and&nbsp;hgeie&nbsp;is&nbsp;nonzero&nbsp;in&nbsp;any&nbsp;bit<br>
//&nbsp;TODO:&nbsp;hip.VSEI&nbsp;is&nbsp;1&nbsp;if&nbsp;hgeip[hstatus.VGEIN]&nbsp;is&nbsp;1<br>
<br>
function&nbsp;legalize_hgeie(v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;xlenbits&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;[v&nbsp;with&nbsp;0&nbsp;=&nbsp;bitzero]<br>
}</span><br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Machine&nbsp;&&nbsp;Hypervisor&nbsp;trap&nbsp;information&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;mtinst&nbsp;:&nbsp;xlenbits<br>
register&nbsp;mtval2&nbsp;:&nbsp;xlenbits<br>
<br>
register&nbsp;htinst&nbsp;:&nbsp;xlenbits<br>
register&nbsp;htval&nbsp;&nbsp;:&nbsp;xlenbits<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Hypervisor&nbsp;Guest&nbsp;Address&nbsp;Translation&nbsp;and&nbsp;Protection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
bitfield&nbsp;Hgatp64&nbsp;:&nbsp;bits(64)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;Mode&nbsp;:&nbsp;63&nbsp;..&nbsp;60,<br>
&nbsp;&nbsp;Vmid&nbsp;:&nbsp;57&nbsp;..&nbsp;44,<br>
&nbsp;&nbsp;PPN&nbsp;&nbsp;:&nbsp;43&nbsp;..&nbsp;0<br>
}<br>
<br>
function&nbsp;legalize_hgatp64(a&nbsp;:&nbsp;Architecture,&nbsp;o&nbsp;:&nbsp;bits(64),&nbsp;v&nbsp;:&nbsp;bits(64))&nbsp;-&gt;&nbsp;bits(64)&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Hgatp64(v[63&nbsp;..&nbsp;60]&nbsp;@&nbsp;0b00&nbsp;@&nbsp;v[57&nbsp;..&nbsp;44]&nbsp;@&nbsp;v[43&nbsp;..&nbsp;2]&nbsp;@&nbsp;0b00);<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">match&nbsp;hgatp64Mode_of_bits(a,&nbsp;h.Mode())&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(Bare)&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(120, 85%, 75%)">h.Mode()&nbsp;@&nbsp;zeros(60)</span>,&nbsp;/*&nbsp;remaining&nbsp;fields&nbsp;should&nbsp;be&nbsp;zero&nbsp;when&nbsp;hgatp.Mode&nbsp;is&nbsp;Bare&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(Sv32x4)&nbsp;=&gt;&nbsp;o,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Sv32x4&nbsp;is&nbsp;currently&nbsp;unsupported&nbsp;for&nbsp;satp64&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(Sv39x4)&nbsp;=&gt;&nbsp;<span style="background-color: hsl(120, 85%, 75%)">h.bits()</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(Sv48x4)&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">h.bits()</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(Sv57x4)&nbsp;=&gt;&nbsp;o,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Sv57x4&nbsp;is&nbsp;not&nbsp;yet&nbsp;implemented&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;o,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;(V)S-stage&nbsp;modes&nbsp;are&nbsp;illegal&nbsp;for&nbsp;satp&nbsp;*/<br>
&nbsp;&nbsp;}</span><br>
}</span><br>
<br>
bitfield&nbsp;Hgatp32&nbsp;:&nbsp;bits(32)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;Mode&nbsp;:&nbsp;31,<br>
&nbsp;&nbsp;Vmid&nbsp;:&nbsp;28&nbsp;..&nbsp;22,<br>
&nbsp;&nbsp;PPN&nbsp;&nbsp;:&nbsp;21&nbsp;..&nbsp;0<br>
}<br>
<br>
function&nbsp;legalize_hgatp32(a&nbsp;:&nbsp;Architecture,&nbsp;o&nbsp;:&nbsp;bits(32),&nbsp;v&nbsp;:&nbsp;bits(32))&nbsp;-&gt;&nbsp;bits(32)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;let&nbsp;h&nbsp;=&nbsp;Mk_Hgatp32(v[31&nbsp;..&nbsp;31]&nbsp;@&nbsp;0b00&nbsp;@&nbsp;v[28&nbsp;..&nbsp;22]&nbsp;@&nbsp;v[21&nbsp;..&nbsp;2]&nbsp;@&nbsp;0b00);<br>
&nbsp;&nbsp;match&nbsp;hgatp64Mode_of_bits(a,&nbsp;zero_extend(h.Mode()))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;None()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;o,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(Bare)&nbsp;=&gt;&nbsp;h.Mode()&nbsp;@&nbsp;zeros(31),&nbsp;/*&nbsp;remaining&nbsp;fields&nbsp;should&nbsp;be&nbsp;zero&nbsp;when&nbsp;hgatp.Mode&nbsp;is&nbsp;Bare&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;Some(_)&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;h.bits()<br>
&nbsp;&nbsp;}<br>
}<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;Status&nbsp;Register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
bitfield&nbsp;Vsstatus&nbsp;:&nbsp;xlenbits&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;SD&nbsp;&nbsp;&nbsp;:&nbsp;xlen&nbsp;-&nbsp;1,<br>
&nbsp;&nbsp;/*&nbsp;UXL&nbsp;only&nbsp;exists&nbsp;if&nbsp;HSXLEN&nbsp;==&nbsp;64&nbsp;so&nbsp;it's&nbsp;modelled&nbsp;via&nbsp;explicit&nbsp;an&nbsp;getter&nbsp;and&nbsp;setter&nbsp;below.*/<br>
&nbsp;&nbsp;/*&nbsp;UXL&nbsp;&nbsp;:&nbsp;33&nbsp;..&nbsp;32&nbsp;*/<br>
&nbsp;&nbsp;MXR&nbsp;&nbsp;:&nbsp;19,<br>
&nbsp;&nbsp;SUM&nbsp;&nbsp;:&nbsp;18,<br>
&nbsp;&nbsp;XS&nbsp;&nbsp;&nbsp;:&nbsp;16&nbsp;..&nbsp;15,<br>
&nbsp;&nbsp;FS&nbsp;&nbsp;&nbsp;:&nbsp;14&nbsp;..&nbsp;13,<br>
&nbsp;&nbsp;VS&nbsp;&nbsp;&nbsp;:&nbsp;10&nbsp;..&nbsp;9,<br>
&nbsp;&nbsp;SPP&nbsp;&nbsp;:&nbsp;8,<br>
&nbsp;&nbsp;UBE&nbsp;&nbsp;:&nbsp;6,<br>
&nbsp;&nbsp;SPIE&nbsp;:&nbsp;5,<br>
&nbsp;&nbsp;SIE&nbsp;&nbsp;:&nbsp;1<br>
}<br>
register&nbsp;vsstatus&nbsp;:&nbsp;Vsstatus<br>
<br>
function&nbsp;get_vsstatus_UXL(v&nbsp;:&nbsp;Vsstatus)&nbsp;-&gt;&nbsp;arch_xlen&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;if&nbsp;sizeof(xlen)&nbsp;==&nbsp;32<br>
&nbsp;&nbsp;then&nbsp;arch_to_bits(RV32)<br>
&nbsp;&nbsp;else&nbsp;v.bits()[33&nbsp;..&nbsp;32]<br>
}<br>
<br>
function&nbsp;set_vsstatus_UXL(v&nbsp;:&nbsp;Vsstatus,&nbsp;a&nbsp;:&nbsp;arch_xlen)&nbsp;-&gt;&nbsp;Vsstatus&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;if&nbsp;sizeof(xlen)&nbsp;==&nbsp;32<br>
&nbsp;&nbsp;then&nbsp;v<br>
&nbsp;&nbsp;else&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;vector_update_subrange(v.bits(),&nbsp;33,&nbsp;32,&nbsp;a);<br>
&nbsp;&nbsp;&nbsp;&nbsp;Mk_Vsstatus(v)<br>
&nbsp;&nbsp;}<br>
}</span><br>
<br>
function&nbsp;legalize_vsstatus(vs:&nbsp;Vsstatus,&nbsp;v:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Vsstatus&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;Mk_Mstatus(vs.bits());&nbsp;&nbsp;/*&nbsp;Convert&nbsp;to&nbsp;Mstatus&nbsp;&nbsp;&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;s&nbsp;=&nbsp;legalize_sstatus(m,&nbsp;v);&nbsp;/*&nbsp;Legalize&nbsp;for&nbsp;Sstatus&nbsp;*/<br>
&nbsp;&nbsp;Mk_Vsstatus(s.bits())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Convert&nbsp;back&nbsp;to&nbsp;Vsstatus&nbsp;&nbsp;*/<br>
}</span><br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;Trap&nbsp;Vector&nbsp;Base&nbsp;Address&nbsp;Register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;vstvec&nbsp;:&nbsp;Mtvec<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;Scratch&nbsp;Register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;vsscratch&nbsp;:&nbsp;xlenbits<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;Exception&nbsp;Program&nbsp;Counter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;vsepc&nbsp;:&nbsp;xlenbits<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;Cause&nbsp;Register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;vscause&nbsp;:&nbsp;Mcause<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;Trap&nbsp;Value&nbsp;Register&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;vstval&nbsp;:&nbsp;xlenbits<br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;interrupt&nbsp;enable/pending&nbsp;registers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
/*&nbsp;vsip&nbsp;is&nbsp;a&nbsp;view&nbsp;of&nbsp;mip,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;register&nbsp;defined.&nbsp;*/<br>
<br>
/*!&nbsp;Returns&nbsp;new&nbsp;mip&nbsp;from&nbsp;the&nbsp;previous&nbsp;mip&nbsp;(m)&nbsp;and&nbsp;the&nbsp;written&nbsp;vsip&nbsp;(v)&nbsp;as&nbsp;delegated&nbsp;by&nbsp;hideleg&nbsp;(d)&nbsp;*/<br>
function&nbsp;legalize_vsip(m:&nbsp;Minterrupts,&nbsp;d&nbsp;:&nbsp;Minterrupts,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Minterrupts(v);<br>
&nbsp;&nbsp;/*&nbsp;Since&nbsp;S-mode&nbsp;bits&nbsp;in&nbsp;vsip&nbsp;are&nbsp;aliases&nbsp;for&nbsp;their&nbsp;corresponding&nbsp;VS-mode&nbsp;bits<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;hip&nbsp;when&nbsp;delegated&nbsp;by&nbsp;hideleg,&nbsp;only&nbsp;vsip.SSIP&nbsp;(hip.VSSIP)&nbsp;might&nbsp;be&nbsp;writable&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSSI(m,&nbsp;v.SSI()&nbsp;&&nbsp;d.VSSI());<br>
&nbsp;&nbsp;m<br>
}</span><br>
<br>
/*!&nbsp;Returns&nbsp;vsip&nbsp;view&nbsp;of&nbsp;mip&nbsp;(m)&nbsp;as&nbsp;delegated&nbsp;by&nbsp;hideleg&nbsp;(d)&nbsp;*/<br>
function&nbsp;lower_mip_to_vsip(m&nbsp;:&nbsp;Minterrupts,&nbsp;d&nbsp;:&nbsp;Minterrupts)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;Mk_Minterrupts(zeros());<br>
&nbsp;&nbsp;/*&nbsp;Standard&nbsp;S-mode&nbsp;bits&nbsp;in&nbsp;vsip&nbsp;are&nbsp;aliases&nbsp;of&nbsp;corresponding&nbsp;VS-mode&nbsp;bits&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hip&nbsp;if&nbsp;delegated&nbsp;by&nbsp;hideleg&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;update_SEI(vs,&nbsp;m.VSEI()&nbsp;&&nbsp;d.VSEI());<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;update_STI(vs,&nbsp;m.VSTI()&nbsp;&&nbsp;d.VSTI());<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;update_SSI(vs,&nbsp;m.VSSI()&nbsp;&&nbsp;d.VSSI());<br>
&nbsp;&nbsp;vs<br>
}</span><br>
<br>
/*&nbsp;hie&nbsp;is&nbsp;a&nbsp;view&nbsp;of&nbsp;vsie,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;register&nbsp;defined.&nbsp;*/<br>
<br>
/*!&nbsp;Returns&nbsp;new&nbsp;mie&nbsp;from&nbsp;previous&nbsp;mie&nbsp;(m)&nbsp;and&nbsp;the&nbsp;written&nbsp;vsie&nbsp;(v)&nbsp;as&nbsp;delegated&nbsp;by&nbsp;hideleg&nbsp;(d)&nbsp;*/<br>
function&nbsp;legalize_vsie(m&nbsp;:&nbsp;Minterrupts,&nbsp;d&nbsp;:&nbsp;Minterrupts,&nbsp;v&nbsp;:&nbsp;xlenbits)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;Mk_Minterrupts(v);<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSEI(m,&nbsp;v.SEI()&nbsp;&&nbsp;d.VSEI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSTI(m,&nbsp;v.STI()&nbsp;&&nbsp;d.VSTI());<br>
&nbsp;&nbsp;let&nbsp;m&nbsp;=&nbsp;update_VSSI(m,&nbsp;v.SSI()&nbsp;&&nbsp;d.VSSI());<br>
&nbsp;&nbsp;m<br>
}</span><br>
<br>
/*!&nbsp;Returns&nbsp;vsie&nbsp;view&nbsp;of&nbsp;mie&nbsp;(m)&nbsp;as&nbsp;delegated&nbsp;by&nbsp;hideleg&nbsp;(d)&nbsp;*/<br>
function&nbsp;lower_mie_to_vsie(m&nbsp;:&nbsp;Minterrupts,&nbsp;d&nbsp;:&nbsp;Minterrupts)&nbsp;-&gt;&nbsp;Minterrupts&nbsp;=&nbsp;<span style="background-color: hsl(120, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;Mk_Minterrupts(zeros());<br>
&nbsp;&nbsp;/*&nbsp;Standard&nbsp;S-mode&nbsp;bits&nbsp;in&nbsp;vsie&nbsp;are&nbsp;aliases&nbsp;of&nbsp;corresponding&nbsp;VS-mode&nbsp;bits&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;hie&nbsp;if&nbsp;delegated&nbsp;by&nbsp;hideleg&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;update_SEI(vs,&nbsp;m.VSEI()&nbsp;&&nbsp;d.VSEI());<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;update_STI(vs,&nbsp;m.VSTI()&nbsp;&&nbsp;d.VSTI());<br>
&nbsp;&nbsp;let&nbsp;vs&nbsp;=&nbsp;update_SSI(vs,&nbsp;m.VSSI()&nbsp;&&nbsp;d.VSSI());<br>
&nbsp;&nbsp;vs<br>
}</span><br>
<br>
/*&nbsp;****************************************************************&nbsp;*/<br>
/*&nbsp;Virtual&nbsp;Supervisor&nbsp;address&nbsp;translation&nbsp;&&nbsp;Protection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
register&nbsp;vsatp&nbsp;:&nbsp;xlenbits<br>
</code>
</body>
</html>
