<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>riscv_insts_vext_arith</title></head>
<body>
<h1>riscv_insts_vext_arith.sail (0/1023) 0%</h1>
<code style="display: block">
/*=================================================================================*/<br>
/*&nbsp;&nbsp;Copyright&nbsp;(c)&nbsp;2021-2023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Authors&nbsp;from&nbsp;RIOS&nbsp;Lab,&nbsp;Tsinghua&nbsp;University:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Xinlai&nbsp;Wan&nbsp;&lt;xinlai.w@rioslab.org&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Xi&nbsp;Wang&nbsp;&lt;xi.w@rioslab.org&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yifei&nbsp;Zhu&nbsp;&lt;yifei.z@rioslab.org&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shenwei&nbsp;Hu&nbsp;&lt;shenwei.h@rioslab.org&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kalvin&nbsp;Vu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;Other&nbsp;contributors:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jessica&nbsp;Clarke&nbsp;&lt;jrtc27@jrtc27.com&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Victor&nbsp;Moya&nbsp;&lt;victor.moya@semidynamics.com&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;Redistribution&nbsp;and&nbsp;use&nbsp;in&nbsp;source&nbsp;and&nbsp;binary&nbsp;forms,&nbsp;with&nbsp;or&nbsp;without&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;modification,&nbsp;are&nbsp;permitted&nbsp;provided&nbsp;that&nbsp;the&nbsp;following&nbsp;conditions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;are&nbsp;met:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;1.&nbsp;Redistributions&nbsp;of&nbsp;source&nbsp;code&nbsp;must&nbsp;retain&nbsp;the&nbsp;above&nbsp;copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;2.&nbsp;Redistributions&nbsp;in&nbsp;binary&nbsp;form&nbsp;must&nbsp;reproduce&nbsp;the&nbsp;above&nbsp;copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer&nbsp;in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;documentation&nbsp;and/or&nbsp;other&nbsp;materials&nbsp;provided&nbsp;with&nbsp;the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribution.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHOR&nbsp;AND&nbsp;CONTRIBUTORS&nbsp;``AS&nbsp;IS''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS&nbsp;OR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;TO,&nbsp;THE&nbsp;IMPLIED&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;PARTICULAR&nbsp;PURPOSE&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHOR&nbsp;OR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;CONTRIBUTORS&nbsp;BE&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,&nbsp;EVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;SUCH&nbsp;DAMAGE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*=================================================================================*/<br>
<br>
/*&nbsp;*******************************************************************************&nbsp;*/<br>
/*&nbsp;This&nbsp;file&nbsp;implements&nbsp;part&nbsp;of&nbsp;the&nbsp;vector&nbsp;extension.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;Chapter&nbsp;11:&nbsp;Vector&nbsp;Integer&nbsp;Arithmetic&nbsp;Instructions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;Chapter&nbsp;12:&nbsp;Vector&nbsp;Fixed-Point&nbsp;Arithmetic&nbsp;Instructions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;Chapter&nbsp;16:&nbsp;Vector&nbsp;Permutation&nbsp;Instructions&nbsp;(integer&nbsp;part)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
/*&nbsp;*******************************************************************************&nbsp;*/<br>
<br>
/*&nbsp;*******************************&nbsp;OPIVV&nbsp;(VVTYPE)&nbsp;********************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VVTYPE&nbsp;:&nbsp;(vvfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_vvfunct6&nbsp;:&nbsp;vvfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VMINU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VMIN</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VMAXU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VMAX</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VAND</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VOR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VXOR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VRGATHER</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VRGATHEREI16</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSSUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSLL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSMUL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VV_VSSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_vvfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b000&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW_pow&nbsp;&nbsp;=&nbsp;get_sew_pow();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;VLEN_pow&nbsp;=&nbsp;get_vlen_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;+&nbsp;vs1_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;-&nbsp;vs1_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;&&nbsp;vs1_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;|&nbsp;vs1_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VXOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;^&nbsp;vs1_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">unsigned_saturation('m,&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">signed_saturation('m,&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;unsigned(vs2_val[i])&nbsp;&lt;&nbsp;unsigned(vs1_val[i])&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">unsigned_saturation('m,&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]))</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">signed_saturation('m,&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_mul&nbsp;=&nbsp;to_bits('m&nbsp;*&nbsp;2,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(vs1_val[i]));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_mul,&nbsp;'m&nbsp;-&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;(result_mul&nbsp;&gt;&gt;&nbsp;('m&nbsp;-&nbsp;1))&nbsp;+&nbsp;zero_extend('m&nbsp;*&nbsp;2,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signed_saturation('m,&nbsp;result_wide['m..0])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSLL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs2_val[i]&nbsp;&lt;&lt;&nbsp;shift_amount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VSSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VMINU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;min(unsigned(vs2_val[i]),&nbsp;unsigned(vs1_val[i])))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VMIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;min(signed(vs2_val[i]),&nbsp;signed(vs1_val[i])))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VMAXU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;max(unsigned(vs2_val[i]),&nbsp;unsigned(vs1_val[i])))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VMAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;max(signed(vs2_val[i]),&nbsp;signed(vs1_val[i])))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VRGATHER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(<span style="background-color: hsl(0, 85%, 40%)">vs1&nbsp;==&nbsp;vd&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 35%)">vs2&nbsp;==&nbsp;vd</span></span>)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;idx&nbsp;=&nbsp;unsigned(vs1_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;VLMAX&nbsp;=&nbsp;int_power(2,&nbsp;LMUL_pow&nbsp;+&nbsp;VLEN_pow&nbsp;-&nbsp;SEW_pow);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(VLMAX&nbsp;&lt;=&nbsp;'n);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;idx&nbsp;&lt;&nbsp;VLMAX&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[idx]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VV_VRGATHEREI16&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(<span style="background-color: hsl(0, 85%, 40%)">vs1&nbsp;==&nbsp;vd&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 35%)">vs2&nbsp;==&nbsp;vd</span></span>)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;vrgatherei16.vv&nbsp;uses&nbsp;SEW/LMUL&nbsp;for&nbsp;the&nbsp;data&nbsp;in&nbsp;vs2&nbsp;but&nbsp;EEW=16&nbsp;and&nbsp;EMUL&nbsp;=&nbsp;(16/SEW)*LMUL&nbsp;for&nbsp;the&nbsp;indices&nbsp;in&nbsp;vs1&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;vs1_new&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits(16))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;16,&nbsp;4&nbsp;+&nbsp;LMUL_pow&nbsp;-&nbsp;SEW_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;idx&nbsp;=&nbsp;unsigned(vs1_new[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;VLMAX&nbsp;=&nbsp;int_power(2,&nbsp;LMUL_pow&nbsp;+&nbsp;VLEN_pow&nbsp;-&nbsp;SEW_pow);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(VLMAX&nbsp;&lt;=&nbsp;'n);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;idx&nbsp;&lt;&nbsp;VLMAX&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[idx]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;vvtype_mnemonic&nbsp;:&nbsp;vvfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VV_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vadd.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsub.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vand.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vor.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VXOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vxor.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VRGATHER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrgather.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VRGATHEREI16&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrgatherei16.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsaddu.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsadd.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssubu.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssub.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSLL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsll.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsmul.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsrl.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsra.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssrl.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VSSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssra.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VMINU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vminu.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VMIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmin.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VMAXU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmaxu.vv&quot;</span>,<br>
&nbsp;&nbsp;VV_VMAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmax.vv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vvtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**************************&nbsp;OPIVV&nbsp;(WVTYPE&nbsp;Narrowing)&nbsp;***************************&nbsp;*/<br>
/*&nbsp;**************&nbsp;Vector&nbsp;Narrowing&nbsp;Integer&nbsp;Right&nbsp;Shift&nbsp;Instructions&nbsp;**************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;NVSTYPE&nbsp;:&nbsp;(nvsfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_nvsfunct6&nbsp;:&nbsp;nvsfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NVS_VNSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NVS_VNSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101101<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;NVSTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_nvsfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b000&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(NVSTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_widen,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW_widen&nbsp;&lt;=&nbsp;64);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVS_VNSRL&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVS_VNSRA&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('o&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;arith_shifted&nbsp;:&nbsp;bits('o)&nbsp;=&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(arith_shifted,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;nvstype_mnemonic&nbsp;:&nbsp;nvsfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;NVS_VNSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnsrl.wv&quot;</span>,<br>
&nbsp;&nbsp;NVS_VNSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnsra.wv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;NVSTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;nvstype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**************************&nbsp;OPIVV&nbsp;(WVTYPE&nbsp;Narrowing)&nbsp;***************************&nbsp;*/<br>
/*&nbsp;***************&nbsp;Vector&nbsp;Narrowing&nbsp;Fixed-Point&nbsp;Clip&nbsp;Instructions&nbsp;****************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;NVTYPE&nbsp;:&nbsp;(nvfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_nvfunct6&nbsp;:&nbsp;nvfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NV_VNCLIPU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NV_VNCLIP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101111<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;NVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_nvfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b000&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(NVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_widen,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW_widen&nbsp;&lt;=&nbsp;64);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(vs1_val[i],&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NV_VNCLIPU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount)&nbsp;+&nbsp;zero_extend('o,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned_saturation('m,&nbsp;result_wide);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NV_VNCLIP&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;4)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;'o)&nbsp;+&nbsp;zero_extend('o,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signed_saturation('m,&nbsp;result_wide);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;nvtype_mnemonic&nbsp;:&nbsp;nvfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;NV_VNCLIPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnclipu.wv&quot;</span>,<br>
&nbsp;&nbsp;NV_VNCLIP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnclip.wv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;NVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;nvtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**********************&nbsp;OPIVV&nbsp;(Integer&nbsp;Merge&nbsp;Instruction)&nbsp;**********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MASKTYPEV&nbsp;:&nbsp;(regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MASKTYPEV&nbsp;(vs2,&nbsp;vs1,&nbsp;&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b0&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b000&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MASKTYPEV(vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;start_element&nbsp;=&nbsp;get_start_element();<br>
&nbsp;&nbsp;let&nbsp;end_element&nbsp;&nbsp;&nbsp;=&nbsp;get_end_element();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);&nbsp;/*&nbsp;max(VLMAX,VLEN/SEW))&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;real_num_elem&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;LMUL_pow&nbsp;&gt;=&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">num_elem</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">num_elem&nbsp;/&nbsp;(0&nbsp;-&nbsp;LMUL_pow)</span></span>;&nbsp;/*&nbsp;VLMAX&nbsp;*/<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_masked(vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b0,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;let&nbsp;tail_ag&nbsp;:&nbsp;agtype&nbsp;=&nbsp;get_vtype_vta();<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;i&nbsp;&lt;&nbsp;start_element&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;vd_val[i]<br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;<span style="background-color: hsl(0, 85%, 55%)">i&nbsp;&gt;&nbsp;end_element&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 50%)">i&nbsp;&gt;=&nbsp;real_num_elem</span></span>&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;tail_ag&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNDISTURBED&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGNOSTIC&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>&nbsp;/*&nbsp;TODO:&nbsp;configuration&nbsp;support&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;the&nbsp;merge&nbsp;operates&nbsp;on&nbsp;all&nbsp;body&nbsp;elements&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">if&nbsp;vm_val[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vs1_val[i]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vs2_val[i]</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MASKTYPEV(vs2,&nbsp;vs1,&nbsp;vd)<br>
&lt;-&gt;&nbsp;&quot;vmerge.vvm&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;&quot;v0&quot;<br>
<br>
/*&nbsp;**********************&nbsp;OPIVV&nbsp;(Integer&nbsp;Move&nbsp;Instruction)&nbsp;***********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MOVETYPEV&nbsp;:&nbsp;(regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MOVETYPEV&nbsp;(vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b1&nbsp;@&nbsp;0b00000&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b000&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MOVETYPEV(vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_unmasked()&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b1,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;result[i]&nbsp;=&nbsp;vs1_val[i]</span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MOVETYPEV(vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmv.v.v&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)<br>
<br>
/*&nbsp;*******************************&nbsp;OPIVX&nbsp;(VXTYPE)&nbsp;********************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VXTYPE&nbsp;:&nbsp;(vxfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_vxfunct6&nbsp;:&nbsp;vxfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VRSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VMINU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VMIN</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VMAXU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VMAX</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VAND</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VOR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VXOR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSSUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSLL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSMUL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_vxfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b100&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VADD&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;+&nbsp;rs1_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSUB&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;-&nbsp;rs1_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VRSUB&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">rs1_val&nbsp;-&nbsp;vs2_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VAND&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;&&nbsp;rs1_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;|&nbsp;rs1_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VXOR&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;^&nbsp;rs1_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSADDU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">unsigned_saturation('m,&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val)&nbsp;)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSADD&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">signed_saturation('m,&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val)&nbsp;)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSSUBU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;unsigned(vs2_val[i])&nbsp;&lt;&nbsp;unsigned(rs1_val)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">unsigned_saturation('m,&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val)&nbsp;)</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSSUB&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">signed_saturation('m,&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val)&nbsp;)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSMUL&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_mul&nbsp;=&nbsp;to_bits('m&nbsp;*&nbsp;2,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(rs1_val));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_mul,&nbsp;'m&nbsp;-&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;(result_mul&nbsp;&gt;&gt;&nbsp;('m&nbsp;-&nbsp;1))&nbsp;+&nbsp;zero_extend('m&nbsp;*&nbsp;2,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signed_saturation('m,&nbsp;result_wide['m..0])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSLL&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs2_val[i]&nbsp;&lt;&lt;&nbsp;shift_amount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSRL&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSRA&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSSRL&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSSRA&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VMINU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;min(unsigned(vs2_val[i]),&nbsp;unsigned(rs1_val)))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VMIN&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;min(signed(vs2_val[i]),&nbsp;signed(rs1_val)))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VMAXU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;max(unsigned(vs2_val[i]),&nbsp;unsigned(rs1_val)))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VMAX&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">to_bits(SEW,&nbsp;max(signed(vs2_val[i]),&nbsp;signed(rs1_val)))</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;vxtype_mnemonic&nbsp;:&nbsp;vxfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VX_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vadd.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsub.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VRSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrsub.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vand.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vor.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VXOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vxor.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsaddu.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsadd.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssubu.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssub.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSLL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsll.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsmul.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsrl.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsra.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssrl.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssra.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VMINU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vminu.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VMIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmin.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VMAXU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmaxu.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VMAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmax.vx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vxtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**************************&nbsp;OPIVX&nbsp;(WXTYPE&nbsp;Narrowing)&nbsp;***************************&nbsp;*/<br>
/*&nbsp;**************&nbsp;Vector&nbsp;Narrowing&nbsp;Integer&nbsp;Right&nbsp;Shift&nbsp;Instructions&nbsp;**************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;NXSTYPE&nbsp;:&nbsp;(nxsfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_nxsfunct6&nbsp;:&nbsp;nxsfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NXS_VNSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NXS_VNSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101101<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;NXSTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_nxsfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b100&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(NXSTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_widen,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW_widen&nbsp;&lt;=&nbsp;64);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NXS_VNSRL&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NXS_VNSRA&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('o&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;arith_shifted&nbsp;:&nbsp;bits('o)&nbsp;=&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(arith_shifted,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;nxstype_mnemonic&nbsp;:&nbsp;nxsfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;NXS_VNSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnsrl.wx&quot;</span>,<br>
&nbsp;&nbsp;NXS_VNSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnsra.wx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;NXSTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;nxstype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**************************&nbsp;OPIVX&nbsp;(WXTYPE&nbsp;Narrowing)&nbsp;***************************&nbsp;*/<br>
/*&nbsp;***************&nbsp;Vector&nbsp;Narrowing&nbsp;Fixed-Point&nbsp;Clip&nbsp;Instructions&nbsp;****************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;NXTYPE&nbsp;:&nbsp;(nxfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_nxfunct6&nbsp;:&nbsp;nxfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NX_VNCLIPU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NX_VNCLIP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101111<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;NXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_nxfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b100&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(NXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_widen,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW_widen&nbsp;&lt;=&nbsp;64);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(rs1_val,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NX_VNCLIPU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount)&nbsp;+&nbsp;zero_extend('o,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned_saturation('m,&nbsp;result_wide)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NX_VNCLIP&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;4)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;'o)&nbsp;+&nbsp;zero_extend('o,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signed_saturation('m,&nbsp;result_wide)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;nxtype_mnemonic&nbsp;:&nbsp;nxfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;NX_VNCLIPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnclipu.wx&quot;</span>,<br>
&nbsp;&nbsp;NX_VNCLIP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnclip.wx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;NXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;nxtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;*****************&nbsp;OPIVX&nbsp;(Vector&nbsp;Slide&nbsp;&&nbsp;Gather&nbsp;Instructions)&nbsp;******************&nbsp;*/<br>
/*&nbsp;Slide&nbsp;and&nbsp;gather&nbsp;instructions&nbsp;extend&nbsp;rs1/imm&nbsp;to&nbsp;XLEN&nbsp;intead&nbsp;of&nbsp;SEW&nbsp;bits&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VXSG&nbsp;:&nbsp;(vxsgfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_vxsgfunct6&nbsp;:&nbsp;vxsgfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSLIDEUP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VSLIDEDOWN</span>&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VX_VRGATHER</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001100<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VXSG(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_vxsgfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b100&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VXSG(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW_pow&nbsp;&nbsp;=&nbsp;get_sew_pow();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;VLEN_pow&nbsp;=&nbsp;get_vlen_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;nat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;unsigned(X(rs1));<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSLIDEUP&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(vs2&nbsp;==&nbsp;vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;i&nbsp;&gt;=&nbsp;rs1_val&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[i&nbsp;-&nbsp;rs1_val]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vd_val[i]</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VSLIDEDOWN&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;VLMAX&nbsp;=&nbsp;int_power(2,&nbsp;LMUL_pow&nbsp;+&nbsp;VLEN_pow&nbsp;-&nbsp;SEW_pow);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(<span style="background-color: hsl(0, 85%, 45%)">VLMAX&nbsp;&gt;&nbsp;0&nbsp;&&nbsp;<span style="background-color: hsl(0, 85%, 40%)">VLMAX&nbsp;&lt;=&nbsp;'n</span></span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;i&nbsp;+&nbsp;rs1_val&nbsp;&lt;&nbsp;VLMAX&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[i&nbsp;+&nbsp;rs1_val]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VX_VRGATHER&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(vs2&nbsp;==&nbsp;vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;VLMAX&nbsp;=&nbsp;int_power(2,&nbsp;LMUL_pow&nbsp;+&nbsp;VLEN_pow&nbsp;-&nbsp;SEW_pow);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(<span style="background-color: hsl(0, 85%, 45%)">VLMAX&nbsp;&gt;&nbsp;0&nbsp;&&nbsp;<span style="background-color: hsl(0, 85%, 40%)">VLMAX&nbsp;&lt;=&nbsp;'n</span></span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;rs1_val&nbsp;&lt;&nbsp;VLMAX&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[rs1_val]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;vxsg_mnemonic&nbsp;:&nbsp;vxsgfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VX_VSLIDEUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vslideup.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VSLIDEDOWN&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vslidedown.vx&quot;</span>,<br>
&nbsp;&nbsp;VX_VRGATHER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrgather.vx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VXSG(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vxsg_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**********************&nbsp;OPIVX&nbsp;(Integer&nbsp;Merge&nbsp;Instruction)&nbsp;**********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MASKTYPEX&nbsp;:&nbsp;(regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MASKTYPEX(vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b0&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b100&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MASKTYPEX(vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;start_element&nbsp;=&nbsp;get_start_element();<br>
&nbsp;&nbsp;let&nbsp;end_element&nbsp;&nbsp;&nbsp;=&nbsp;get_end_element();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);&nbsp;/*&nbsp;max(VLMAX,VLEN/SEW))&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;real_num_elem&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;LMUL_pow&nbsp;&gt;=&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">num_elem</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">num_elem&nbsp;/&nbsp;(0&nbsp;-&nbsp;LMUL_pow)</span></span>;&nbsp;/*&nbsp;VLMAX&nbsp;*/<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_masked(vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b0,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;let&nbsp;tail_ag&nbsp;:&nbsp;agtype&nbsp;=&nbsp;get_vtype_vta();<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;i&nbsp;&lt;&nbsp;start_element&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;vd_val[i]<br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;<span style="background-color: hsl(0, 85%, 55%)">i&nbsp;&gt;&nbsp;end_element&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 50%)">i&nbsp;&gt;=&nbsp;real_num_elem</span></span>&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;tail_ag&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNDISTURBED&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGNOSTIC&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>&nbsp;/*&nbsp;TODO:&nbsp;configuration&nbsp;support&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;the&nbsp;merge&nbsp;operates&nbsp;on&nbsp;all&nbsp;body&nbsp;elements&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">if&nbsp;vm_val[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 45%)">rs1_val</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vs2_val[i]</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MASKTYPEX(vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmerge.vxm&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;&quot;v0&quot;<br>
<br>
/*&nbsp;**********************&nbsp;OPIVX&nbsp;(Integer&nbsp;Move&nbsp;Instruction)&nbsp;***********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MOVETYPEX&nbsp;:&nbsp;(regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MOVETYPEX&nbsp;(rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b1&nbsp;@&nbsp;0b00000&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b100&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MOVETYPEX(rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_unmasked()&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;'m);<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b1,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;result[i]&nbsp;=&nbsp;rs1_val</span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MOVETYPEX(rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmv.v.x&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)<br>
<br>
/*&nbsp;*******************************&nbsp;OPIVI&nbsp;(VITYPE)&nbsp;********************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VITYPE&nbsp;:&nbsp;(vifunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;bits(5),&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_vifunct6&nbsp;:&nbsp;vifunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VRSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b000011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VAND</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VOR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VXOR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSLL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VITYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_vifunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VITYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sign_extend(simm);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VADD&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;+&nbsp;imm_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VRSUB&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">imm_val&nbsp;-&nbsp;vs2_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VAND&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;&&nbsp;imm_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;|&nbsp;imm_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VXOR&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;^&nbsp;imm_val</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSADDU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">unsigned_saturation('m,&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;imm_val)&nbsp;)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSADD&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">signed_saturation('m,&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;imm_val)&nbsp;)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSLL&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(zero_extend('m,&nbsp;simm),&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs2_val[i]&nbsp;&lt;&lt;&nbsp;shift_amount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSRL&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(zero_extend('m,&nbsp;simm),&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSRA&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(zero_extend('m,&nbsp;simm),&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSSRL&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(zero_extend('m,&nbsp;simm),&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSSRA&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(zero_extend('m,&nbsp;simm),&nbsp;SEW);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;vitype_mnemonic&nbsp;:&nbsp;vifunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VI_VADD&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vadd.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VRSUB&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrsub.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VAND&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vand.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VOR&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vor.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VXOR&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vxor.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSADDU&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsaddu.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSADD&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsadd.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSLL&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsll.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSRL&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsrl.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSRA&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsra.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSSRL&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssrl.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSSRA&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vssra.vi&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VITYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vitype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;hex_bits_5(simm)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**************************&nbsp;OPIVI&nbsp;(WITYPE&nbsp;Narrowing)&nbsp;***************************&nbsp;*/<br>
/*&nbsp;**************&nbsp;Vector&nbsp;Narrowing&nbsp;Integer&nbsp;Right&nbsp;Shift&nbsp;Instructions&nbsp;**************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;NISTYPE&nbsp;:&nbsp;(nisfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_nisfunct6&nbsp;:&nbsp;nisfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NIS_VNSRL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NIS_VNSRA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101101<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;NISTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_nisfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(NISTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_widen,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sign_extend(simm);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW_widen&nbsp;&lt;=&nbsp;64);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIS_VNSRL&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(imm_val,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIS_VNSRA&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(imm_val,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('o&nbsp;*&nbsp;2)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;arith_shifted&nbsp;:&nbsp;bits('o)&nbsp;=&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(arith_shifted,&nbsp;0,&nbsp;SEW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;nistype_mnemonic&nbsp;:&nbsp;nisfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;NIS_VNSRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnsrl.wi&quot;</span>,<br>
&nbsp;&nbsp;NIS_VNSRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnsra.wi&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;NISTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;nistype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;hex_bits_5(simm)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**************************&nbsp;OPIVI&nbsp;(WITYPE&nbsp;Narrowing)&nbsp;***************************&nbsp;*/<br>
/*&nbsp;***************&nbsp;Vector&nbsp;Narrowing&nbsp;Fixed-Point&nbsp;Clip&nbsp;Instructions&nbsp;****************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;NITYPE&nbsp;:&nbsp;(nifunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_nifunct6&nbsp;:&nbsp;nifunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NI_VNCLIPU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">NI_VNCLIP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101111<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;NITYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_nifunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(NITYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_widen,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sign_extend(simm);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW_widen&nbsp;&lt;=&nbsp;64);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;shift_amount&nbsp;=&nbsp;get_shift_amount(imm_val,&nbsp;SEW_widen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(vs2_val[i],&nbsp;shift_amount);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NI_VNCLIPU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;(vs2_val[i]&nbsp;&gt;&gt;&nbsp;shift_amount)&nbsp;+&nbsp;zero_extend('o,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned_saturation('m,&nbsp;result_wide)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NI_VNCLIP&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v_double&nbsp;:&nbsp;bits('m&nbsp;*&nbsp;4)&nbsp;=&nbsp;sign_extend(vs2_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_wide&nbsp;=&nbsp;slice(v_double&nbsp;&gt;&gt;&nbsp;shift_amount,&nbsp;0,&nbsp;'o)&nbsp;+&nbsp;zero_extend('o,&nbsp;rounding_incr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signed_saturation('m,&nbsp;result_wide)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;nitype_mnemonic&nbsp;:&nbsp;nifunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;NI_VNCLIPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnclipu.wi&quot;</span>,<br>
&nbsp;&nbsp;NI_VNCLIP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnclip.wi&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;NITYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;nitype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;hex_bits_5(simm)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;*****************&nbsp;OPIVI&nbsp;(Vector&nbsp;Slide&nbsp;&&nbsp;Gather&nbsp;Instructions)&nbsp;******************&nbsp;*/<br>
/*&nbsp;Slide&nbsp;and&nbsp;gather&nbsp;instructions&nbsp;extend&nbsp;rs1/imm&nbsp;to&nbsp;XLEN&nbsp;intead&nbsp;of&nbsp;SEW&nbsp;bits&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VISG&nbsp;:&nbsp;(visgfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;bits(5),&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_visgfunct6&nbsp;:&nbsp;visgfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSLIDEUP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VSLIDEDOWN</span>&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VI_VRGATHER</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001100<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VISG(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_visgfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VISG(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW_pow&nbsp;&nbsp;=&nbsp;get_sew_pow();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;VLEN_pow&nbsp;=&nbsp;get_vlen_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;:&nbsp;nat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;unsigned(zero_extend(sizeof(xlen),&nbsp;simm));<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSLIDEUP&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(vs2&nbsp;==&nbsp;vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;i&nbsp;&gt;=&nbsp;imm_val&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[i&nbsp;-&nbsp;imm_val]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vd_val[i]</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VSLIDEDOWN&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;VLMAX&nbsp;=&nbsp;int_power(2,&nbsp;LMUL_pow&nbsp;+&nbsp;VLEN_pow&nbsp;-&nbsp;SEW_pow);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(<span style="background-color: hsl(0, 85%, 45%)">VLMAX&nbsp;&gt;&nbsp;0&nbsp;&&nbsp;<span style="background-color: hsl(0, 85%, 40%)">VLMAX&nbsp;&lt;=&nbsp;'n</span></span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;i&nbsp;+&nbsp;imm_val&nbsp;&lt;&nbsp;VLMAX&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[i&nbsp;+&nbsp;imm_val]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VI_VRGATHER&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(vs2&nbsp;==&nbsp;vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;VLMAX&nbsp;=&nbsp;int_power(2,&nbsp;LMUL_pow&nbsp;+&nbsp;VLEN_pow&nbsp;-&nbsp;SEW_pow);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(<span style="background-color: hsl(0, 85%, 45%)">VLMAX&nbsp;&gt;&nbsp;0&nbsp;&&nbsp;<span style="background-color: hsl(0, 85%, 40%)">VLMAX&nbsp;&lt;=&nbsp;'n</span></span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;imm_val&nbsp;&lt;&nbsp;VLMAX&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[imm_val]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">zeros()</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;visg_mnemonic&nbsp;:&nbsp;visgfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VI_VSLIDEUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vslideup.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VSLIDEDOWN&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vslidedown.vi&quot;</span>,<br>
&nbsp;&nbsp;VI_VRGATHER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrgather.vi&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VISG(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;simm,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;visg_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(simm)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;**********************&nbsp;OPIVI&nbsp;(Integer&nbsp;Merge&nbsp;Instruction)&nbsp;**********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MASKTYPEI&nbsp;:&nbsp;(regidx,&nbsp;bits(5),&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MASKTYPEI(vs2,&nbsp;simm,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b0&nbsp;@&nbsp;vs2&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MASKTYPEI(vs2,&nbsp;simm,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;start_element&nbsp;=&nbsp;get_start_element();<br>
&nbsp;&nbsp;let&nbsp;end_element&nbsp;&nbsp;&nbsp;=&nbsp;get_end_element();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);&nbsp;/*&nbsp;max(VLMAX,VLEN/SEW))&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;real_num_elem&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;LMUL_pow&nbsp;&gt;=&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">num_elem</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 70%)">num_elem&nbsp;/&nbsp;(0&nbsp;-&nbsp;LMUL_pow)</span></span>;&nbsp;/*&nbsp;VLMAX&nbsp;*/<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_masked(vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b0,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sign_extend(simm);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;let&nbsp;tail_ag&nbsp;:&nbsp;agtype&nbsp;=&nbsp;get_vtype_vta();<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;i&nbsp;&lt;&nbsp;start_element&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;vd_val[i]<br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;<span style="background-color: hsl(0, 85%, 55%)">i&nbsp;&gt;&nbsp;end_element&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 50%)">i&nbsp;&gt;=&nbsp;real_num_elem</span></span>&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;tail_ag&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNDISTURBED&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGNOSTIC&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>&nbsp;/*&nbsp;TODO:&nbsp;configuration&nbsp;support&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;the&nbsp;merge&nbsp;operates&nbsp;on&nbsp;all&nbsp;body&nbsp;elements&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">if&nbsp;vm_val[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 45%)">imm_val</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vs2_val[i]</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MASKTYPEI(vs2,&nbsp;simm,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmerge.vim&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;hex_bits_5(simm)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;&quot;v0&quot;<br>
<br>
/*&nbsp;**********************&nbsp;OPIVI&nbsp;(Integer&nbsp;Move&nbsp;Instruction)&nbsp;***********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MOVETYPEI&nbsp;:&nbsp;(regidx,&nbsp;bits(5))<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MOVETYPEI&nbsp;(vd,&nbsp;simm)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b1&nbsp;@&nbsp;0b00000&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MOVETYPEI(vd,&nbsp;simm))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_unmasked()&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b1,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sign_extend(simm);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;result[i]&nbsp;=&nbsp;imm_val</span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MOVETYPEI(vd,&nbsp;simm)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmv.v.i&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;hex_bits_5(simm)<br>
<br>
/*&nbsp;*********************&nbsp;OPIVI&nbsp;(Whole&nbsp;Vector&nbsp;Register&nbsp;Move)&nbsp;**********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VMVRTYPE&nbsp;:&nbsp;(regidx,&nbsp;bits(5),&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VMVRTYPE(vs2,&nbsp;simm,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b100111&nbsp;@&nbsp;0b1&nbsp;@&nbsp;vs2&nbsp;@&nbsp;simm&nbsp;@&nbsp;0b011&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VMVRTYPE(vs2,&nbsp;simm,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;start_element&nbsp;=&nbsp;get_start_element();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;imm_val&nbsp;=&nbsp;unsigned(zero_extend(sizeof(xlen),&nbsp;simm));<br>
&nbsp;&nbsp;let&nbsp;EMUL&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;imm_val&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;not(<span style="background-color: hsl(0, 85%, 70%)">EMUL&nbsp;==&nbsp;1&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 65%)">EMUL&nbsp;==&nbsp;2&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 60%)">EMUL&nbsp;==&nbsp;4&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 55%)">EMUL&nbsp;==&nbsp;8</span></span></span></span>)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;let&nbsp;EMUL_pow&nbsp;=&nbsp;log2(EMUL);<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(EMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b1,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;EMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;EMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;i&nbsp;&lt;&nbsp;start_element&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">vd_val[i]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 60%)">vs2_val[i]</span></span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;EMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;simm_string&nbsp;:&nbsp;bits(5)&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;0b00000&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;1&quot;</span>,<br>
&nbsp;&nbsp;0b00001&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;2&quot;</span>,<br>
&nbsp;&nbsp;0b00011&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;4&quot;</span>,<br>
&nbsp;&nbsp;0b00111&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;8&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VMVRTYPE(vs2,&nbsp;simm,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmv&quot;&nbsp;^&nbsp;simm_string(simm)&nbsp;^&nbsp;&quot;r.v&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)<br>
<br>
/*&nbsp;*******************************&nbsp;OPMVV&nbsp;(VVTYPE)&nbsp;********************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MVVTYPE&nbsp;:&nbsp;(mvvfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_mvvfunct6&nbsp;:&nbsp;mvvfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VAADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VAADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VASUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VASUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VMUL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VMULH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VMULHU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VMULHSU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VDIVU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VDIV</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VREMU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VREM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_mvvfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VAADDU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_add&nbsp;=&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_add,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_add&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VAADD&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_add&nbsp;=&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_add,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_add&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VASUBU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_sub&nbsp;=&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_sub,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_sub&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VASUB&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_sub&nbsp;=&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs1_val[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_sub,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_sub&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(vs1_val[i]),&nbsp;0)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VMULH&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(vs1_val[i]),&nbsp;SEW)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VMULHU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;unsigned(vs2_val[i])&nbsp;*&nbsp;unsigned(vs1_val[i]),&nbsp;SEW)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VMULHSU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;unsigned(vs1_val[i]),&nbsp;SEW)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VDIVU&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;q&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;unsigned(vs1_val[i])&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">-1</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">quot_round_zero(unsigned(vs2_val[i]),&nbsp;unsigned(vs1_val[i]))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;q)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VDIV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;elem_max&nbsp;:&nbsp;int&nbsp;=&nbsp;2&nbsp;^&nbsp;(SEW&nbsp;-&nbsp;1)&nbsp;-&nbsp;1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;elem_min&nbsp;:&nbsp;int&nbsp;=&nbsp;0&nbsp;-&nbsp;2&nbsp;^&nbsp;(SEW&nbsp;-&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;q&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;signed(vs1_val[i])&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">-1</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">quot_round_zero(signed(vs2_val[i]),&nbsp;signed(vs1_val[i]))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;check&nbsp;for&nbsp;signed&nbsp;overflow&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;q'&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;q&nbsp;&gt;&nbsp;elem_max&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">elem_min</span>&nbsp;else&nbsp;q</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;q')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VREMU&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;r&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;unsigned(vs1_val[i])&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">unsigned(vs2_val[i])</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">rem_round_zero(unsigned(vs2_val[i]),&nbsp;unsigned(vs1_val[i]))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;signed&nbsp;overflow&nbsp;case&nbsp;returns&nbsp;zero&nbsp;naturally&nbsp;as&nbsp;required&nbsp;due&nbsp;to&nbsp;-1&nbsp;divisor&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;r)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VREM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;r&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;signed(vs1_val[i])&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">signed(vs2_val[i])</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">rem_round_zero(signed(vs2_val[i]),&nbsp;signed(vs1_val[i]))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;signed&nbsp;overflow&nbsp;case&nbsp;returns&nbsp;zero&nbsp;naturally&nbsp;as&nbsp;required&nbsp;due&nbsp;to&nbsp;-1&nbsp;divisor&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;r)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;mvvtype_mnemonic&nbsp;:&nbsp;mvvfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;MVV_VAADDU&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vaaddu.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VAADD&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vaadd.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VASUBU&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vasubu.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VASUB&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vasub.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmul.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VMULH&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmulh.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VMULHU&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmulhu.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VMULHSU&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmulhsu.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VDIVU&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vdivu.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VDIV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vdiv.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VREMU&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vremu.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VREM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrem.vv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;mvvtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;*************************&nbsp;OPMVV&nbsp;(VVtype&nbsp;Multiply-Add)&nbsp;*************************&nbsp;*/<br>
/*&nbsp;Multiply-Add&nbsp;instructions&nbsp;switch&nbsp;the&nbsp;order&nbsp;of&nbsp;source&nbsp;operands&nbsp;in&nbsp;assembly&nbsp;(vs1/rs1&nbsp;before&nbsp;vs2)&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MVVMATYPE&nbsp;:&nbsp;(mvvmafunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_mvvmafunct6&nbsp;:&nbsp;mvvmafunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VMACC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VNMSAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VMADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVV_VNMSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MVVMATYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_mvvmafunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MVVMATYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VMACC&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs1_val[i])&nbsp;*&nbsp;signed(vs2_val[i]),&nbsp;0)&nbsp;+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VNMSAC&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vd_val[i]&nbsp;-&nbsp;get_slice_int(SEW,&nbsp;signed(vs1_val[i])&nbsp;*&nbsp;signed(vs2_val[i]),&nbsp;0)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VMADD&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs1_val[i])&nbsp;*&nbsp;signed(vd_val[i]),&nbsp;0)&nbsp;+&nbsp;vs2_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVV_VNMSUB&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;-&nbsp;get_slice_int(SEW,&nbsp;signed(vs1_val[i])&nbsp;*&nbsp;signed(vd_val[i]),&nbsp;0)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;mvvmatype_mnemonic&nbsp;:&nbsp;mvvmafunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;MVV_VMACC&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmacc.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VNMSAC&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnmsac.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VMADD&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmadd.vv&quot;</span>,<br>
&nbsp;&nbsp;MVV_VNMSUB&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnmsub.vv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MVVMATYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;mvvmatype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;***************************&nbsp;OPMVV&nbsp;(VVTYPE&nbsp;Widening)&nbsp;***************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;WVVTYPE&nbsp;:&nbsp;(wvvfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
mapping&nbsp;encdec_wvvfunct6&nbsp;:&nbsp;wvvfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VSUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VWMUL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VWMULU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVV_VWMULSU</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111010<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;WVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_wvvfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(WVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs1,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))</span></span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VADD&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;+&nbsp;signed(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VSUB&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;-&nbsp;signed(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VADDU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;+&nbsp;unsigned(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VSUBU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;-&nbsp;unsigned(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VWMUL&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VWMULU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;*&nbsp;unsigned(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVV_VWMULSU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;unsigned(vs1_val[i]))</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;wvvtype_mnemonic&nbsp;:&nbsp;wvvfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;WVV_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwadd.vv&quot;</span>,<br>
&nbsp;&nbsp;WVV_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsub.vv&quot;</span>,<br>
&nbsp;&nbsp;WVV_VADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwaddu.vv&quot;</span>,<br>
&nbsp;&nbsp;WVV_VSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsubu.vv&quot;</span>,<br>
&nbsp;&nbsp;WVV_VWMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmul.vv&quot;</span>,<br>
&nbsp;&nbsp;WVV_VWMULU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmulu.vv&quot;</span>,<br>
&nbsp;&nbsp;WVV_VWMULSU&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmulsu.vv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;WVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;wvvtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;***************************&nbsp;OPMVV&nbsp;(WVTYPE&nbsp;Widening)&nbsp;***************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;WVTYPE&nbsp;:&nbsp;(wvfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_wvfunct6&nbsp;:&nbsp;wvfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WV_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WV_VSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WV_VADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WV_VSUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110110<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;WVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_wvfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(WVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs1,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WV_VADD&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;+&nbsp;signed(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WV_VSUB&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;-&nbsp;signed(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WV_VADDU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;+&nbsp;unsigned(vs1_val[i]))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WV_VSUBU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;-&nbsp;unsigned(vs1_val[i]))</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;wvtype_mnemonic&nbsp;:&nbsp;wvfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;WV_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwadd.wv&quot;</span>,<br>
&nbsp;&nbsp;WV_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsub.wv&quot;</span>,<br>
&nbsp;&nbsp;WV_VADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwaddu.wv&quot;</span>,<br>
&nbsp;&nbsp;WV_VSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsubu.wv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;WVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;wvtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;********************&nbsp;OPMVV&nbsp;(VVtype&nbsp;Widening&nbsp;Multiply-Add)&nbsp;*********************&nbsp;*/<br>
/*&nbsp;Multiply-Add&nbsp;instructions&nbsp;switch&nbsp;the&nbsp;order&nbsp;of&nbsp;source&nbsp;operands&nbsp;in&nbsp;assembly&nbsp;(vs1/rs1&nbsp;before&nbsp;vs2)&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;WMVVTYPE&nbsp;:&nbsp;(wmvvfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_wmvvfunct6&nbsp;:&nbsp;wmvvfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVV_VWMACCU</span>&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVV_VWMACC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVV_VWMACCSU</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111111<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;&nbsp;WMVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_wmvvfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(WMVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs1,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))</span></span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVV_VWMACC&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs1_val[i])&nbsp;*&nbsp;signed(vs2_val[i]))&nbsp;+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVV_VWMACCU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs1_val[i])&nbsp;*&nbsp;unsigned(vs2_val[i]))&nbsp;+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVV_VWMACCSU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs1_val[i])&nbsp;*&nbsp;unsigned(vs2_val[i]))+&nbsp;vd_val[i]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;wmvvtype_mnemonic&nbsp;:&nbsp;wmvvfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;WMVV_VWMACCU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmaccu.vv&quot;</span>,<br>
&nbsp;&nbsp;WMVV_VWMACC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmacc.vv&quot;</span>,<br>
&nbsp;&nbsp;WMVV_VWMACCSU&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmaccsu.vv&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;WMVVTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;wmvvtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;******************************&nbsp;OPMVV&nbsp;(VXUNARY0)&nbsp;*******************************&nbsp;*/<br>
/*&nbsp;*******************&nbsp;Vector&nbsp;Integer&nbsp;Extension&nbsp;(SEW/2&nbsp;source)&nbsp;*******************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VEXT2TYPE&nbsp;:&nbsp;(vext2funct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;vext2_vs1&nbsp;:&nbsp;vext2funct6&nbsp;&lt;-&gt;&nbsp;bits(5)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VEXT2_ZVF2</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b00110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VEXT2_SVF2</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b00111<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VEXT2TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">0b010010&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vext2_vs1(funct6)&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VEXT2TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_half&nbsp;=&nbsp;SEW&nbsp;/&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_half&nbsp;=&nbsp;LMUL_pow&nbsp;-&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_half,&nbsp;LMUL_pow_half)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_half,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_half;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_half,&nbsp;LMUL_pow_half,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW&nbsp;&gt;&nbsp;SEW_half);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VEXT2_ZVF2&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">zero_extend(vs2_val[i])</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VEXT2_SVF2&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">sign_extend(vs2_val[i])</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;vext2type_mnemonic&nbsp;:&nbsp;vext2funct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VEXT2_ZVF2&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vzext.vf2&quot;</span>,<br>
&nbsp;&nbsp;VEXT2_SVF2&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsext.vf2&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VEXT2TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vext2type_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;******************************&nbsp;OPMVV&nbsp;(VXUNARY0)&nbsp;*******************************&nbsp;*/<br>
/*&nbsp;*******************&nbsp;Vector&nbsp;Integer&nbsp;Extension&nbsp;(SEW/4&nbsp;source)&nbsp;*******************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VEXT4TYPE&nbsp;:&nbsp;(vext4funct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;vext4_vs1&nbsp;:&nbsp;vext4funct6&nbsp;&lt;-&gt;&nbsp;bits(5)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VEXT4_ZVF4</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b00100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VEXT4_SVF4</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b00101<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VEXT4TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">0b010010&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vext4_vs1(funct6)&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VEXT4TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_quart&nbsp;=&nbsp;SEW&nbsp;/&nbsp;4;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_quart&nbsp;=&nbsp;LMUL_pow&nbsp;-&nbsp;2;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_quart,&nbsp;LMUL_pow_quart)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_quart,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_quart;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_quart,&nbsp;LMUL_pow_quart,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW&nbsp;&gt;&nbsp;SEW_quart);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VEXT4_ZVF4&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">zero_extend(vs2_val[i])</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VEXT4_SVF4&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">sign_extend(vs2_val[i])</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;vext4type_mnemonic&nbsp;:&nbsp;vext4funct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VEXT4_ZVF4&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vzext.vf4&quot;</span>,<br>
&nbsp;&nbsp;VEXT4_SVF4&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsext.vf4&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VEXT4TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vext4type_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;******************************&nbsp;OPMVV&nbsp;(VXUNARY0)&nbsp;*******************************&nbsp;*/<br>
/*&nbsp;*******************&nbsp;Vector&nbsp;Integer&nbsp;Extension&nbsp;(SEW/8&nbsp;source)&nbsp;*******************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VEXT8TYPE&nbsp;:&nbsp;(vext8funct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;vext8_vs1&nbsp;:&nbsp;vext8funct6&nbsp;&lt;-&gt;&nbsp;bits(5)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VEXT8_ZVF8</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b00010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">VEXT8_SVF8</span>&nbsp;&nbsp;&lt;-&gt;&nbsp;0b00011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VEXT8TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">0b010010&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vext8_vs1(funct6)&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VEXT8TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_eighth&nbsp;=&nbsp;SEW&nbsp;/&nbsp;8;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_eighth&nbsp;=&nbsp;LMUL_pow&nbsp;-&nbsp;3;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_eighth,&nbsp;LMUL_pow_eighth)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow_eighth,&nbsp;LMUL_pow))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_eighth;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_eighth,&nbsp;LMUL_pow_eighth,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;assert(SEW&nbsp;&gt;&nbsp;SEW_eighth);<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VEXT8_ZVF8&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">zero_extend(vs2_val[i])</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VEXT8_SVF8&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">sign_extend(vs2_val[i])</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;vext8type_mnemonic&nbsp;:&nbsp;vext8funct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;VEXT8_ZVF8&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vzext.vf8&quot;</span>,<br>
&nbsp;&nbsp;VEXT8_SVF8&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vsext.vf8&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VEXT8TYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;vext8type_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;************************&nbsp;OPMVV&nbsp;(vmv.x.s&nbsp;in&nbsp;VWXUNARY0)&nbsp;*************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VMVXS&nbsp;:&nbsp;(regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VMVXS(vs2,&nbsp;rd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010000&nbsp;@&nbsp;0b1&nbsp;@&nbsp;vs2&nbsp;@&nbsp;0b00000&nbsp;@&nbsp;0b010&nbsp;@&nbsp;rd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VMVXS(vs2,&nbsp;rd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(0,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_unmasked()&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;assert(num_elem&nbsp;&gt;&nbsp;0);<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;0,&nbsp;vs2);<br>
&nbsp;&nbsp;X(rd)&nbsp;=&nbsp;if&nbsp;sizeof(xlen)&nbsp;&lt;&nbsp;SEW&nbsp;then&nbsp;slice(vs2_val[0],&nbsp;0,&nbsp;sizeof(xlen))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;sizeof(xlen)&nbsp;&gt;&nbsp;SEW&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">sign_extend(vs2_val[0])</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 60%)">vs2_val[0]</span></span>;<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VMVXS(vs2,&nbsp;rd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmv.x.s&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;reg_name(rd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)<br>
<br>
/*&nbsp;*********************&nbsp;OPMVV&nbsp;(Vector&nbsp;Compress&nbsp;Instruction)&nbsp;*********************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MVVCOMPRESS&nbsp;:&nbsp;(regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MVVCOMPRESS(vs2,&nbsp;vs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010111&nbsp;@&nbsp;0b1&nbsp;@&nbsp;vs2&nbsp;@&nbsp;vs1&nbsp;@&nbsp;0b010&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MVVCOMPRESS(vs2,&nbsp;vs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;start_element&nbsp;=&nbsp;get_start_element();<br>
&nbsp;&nbsp;let&nbsp;end_element&nbsp;=&nbsp;get_end_element();<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;/*&nbsp;vcompress&nbsp;should&nbsp;always&nbsp;be&nbsp;executed&nbsp;with&nbsp;a&nbsp;vstart&nbsp;of&nbsp;0&nbsp;*/<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;<span style="background-color: hsl(0, 85%, 70%)">start_element&nbsp;!=&nbsp;0&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 65%)">vs1&nbsp;==&nbsp;vd&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 60%)">vs2&nbsp;==&nbsp;vd&nbsp;|&nbsp;<span style="background-color: hsl(0, 85%, 55%)">illegal_vd_unmasked()</span></span></span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vs1_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b0,&nbsp;vs1);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;/*&nbsp;body&nbsp;elements&nbsp;*/<br>
&nbsp;&nbsp;vd_idx&nbsp;:&nbsp;nat&nbsp;=&nbsp;0;<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;i&nbsp;&lt;=&nbsp;end_element&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 55%)">if&nbsp;vs1_val[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">let&nbsp;'p&nbsp;=&nbsp;vd_idx;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert('p&nbsp;&lt;&nbsp;'n);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result['p]&nbsp;=&nbsp;vs2_val[i];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vd_idx&nbsp;=&nbsp;vd_idx&nbsp;+&nbsp;1;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 60%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
&nbsp;&nbsp;/*&nbsp;tail&nbsp;elements&nbsp;*/<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;vd_idx&nbsp;&lt;&nbsp;num_elem&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;tail_ag&nbsp;:&nbsp;agtype&nbsp;=&nbsp;get_vtype_vta();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 55%)">let&nbsp;'p&nbsp;=&nbsp;vd_idx;<br>
&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;'p&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;tail_ag&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNDISTURBED&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGNOSTIC&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">vd_val[i]</span>&nbsp;/*&nbsp;TODO:&nbsp;configuration&nbsp;support&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MVVCOMPRESS(vs2,&nbsp;vs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vcompress.vm&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs1)<br>
<br>
/*&nbsp;*******************************&nbsp;OPMVX&nbsp;(VXTYPE)&nbsp;********************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MVXTYPE&nbsp;:&nbsp;(mvxfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_mvxfunct6&nbsp;:&nbsp;mvxfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VAADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VAADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VASUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VASUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VSLIDE1UP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VSLIDE1DOWN</span>&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b001111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VMUL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VMULH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VMULHU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VMULHSU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VDIVU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VDIV</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VREMU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VREM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b100011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_mvxfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b110&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VAADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_add&nbsp;=&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_add,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_add&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VAADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_add&nbsp;=&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;+&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_add,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_add&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VASUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_sub&nbsp;=&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;zero_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_sub,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_sub&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VASUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;result_sub&nbsp;=&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;vs2_val[i])&nbsp;-&nbsp;sign_extend('m&nbsp;+&nbsp;1,&nbsp;rs1_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rounding_incr&nbsp;=&nbsp;get_fixed_rounding_incr(result_sub,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(result_sub&nbsp;&gt;&gt;&nbsp;1,&nbsp;0,&nbsp;'m)&nbsp;+&nbsp;zero_extend('m,&nbsp;rounding_incr)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VSLIDE1UP&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;(vs2&nbsp;==&nbsp;vd)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 50%)">&#171;Invisible branch not taken here&#187</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;i&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">rs1_val</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[i&nbsp;-&nbsp;1]</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VSLIDE1DOWN&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_elem&nbsp;=&nbsp;get_end_element();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(last_elem&nbsp;&lt;&nbsp;num_elem);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;i&nbsp;&lt;&nbsp;last_elem&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">vs2_val[i&nbsp;+&nbsp;1]</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">rs1_val</span></span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(rs1_val),&nbsp;0)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VMULH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(rs1_val),&nbsp;SEW)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VMULHU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;unsigned(vs2_val[i])&nbsp;*&nbsp;unsigned(rs1_val),&nbsp;SEW)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VMULHSU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;unsigned(rs1_val),&nbsp;SEW)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VDIVU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;q&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;unsigned(rs1_val)&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">-1</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">quot_round_zero(unsigned(vs2_val[i]),&nbsp;unsigned(rs1_val))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;q)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VDIV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;elem_max&nbsp;:&nbsp;int&nbsp;=&nbsp;2&nbsp;^&nbsp;(SEW&nbsp;-&nbsp;1)&nbsp;-&nbsp;1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;elem_min&nbsp;:&nbsp;int&nbsp;=&nbsp;0&nbsp;-&nbsp;2&nbsp;^&nbsp;(SEW&nbsp;-&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;q&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;signed(rs1_val)&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">-1</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">quot_round_zero(signed(vs2_val[i]),&nbsp;signed(rs1_val))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;check&nbsp;for&nbsp;signed&nbsp;overflow&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;q'&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;q&nbsp;&gt;&nbsp;elem_max&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">elem_min</span>&nbsp;else&nbsp;q</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;q')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VREMU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;r&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;unsigned(rs1_val)&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">unsigned(vs2_val[i])</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">rem_round_zero(unsigned(vs2_val[i]),&nbsp;unsigned&nbsp;(rs1_val))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;signed&nbsp;overflow&nbsp;case&nbsp;returns&nbsp;zero&nbsp;naturally&nbsp;as&nbsp;required&nbsp;due&nbsp;to&nbsp;-1&nbsp;divisor&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;r)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VREM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;r&nbsp;:&nbsp;int&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 45%)">if&nbsp;signed(rs1_val)&nbsp;==&nbsp;0&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 40%)">signed(vs2_val[i])</span>&nbsp;else&nbsp;<span style="background-color: hsl(0, 85%, 40%)">rem_round_zero(signed(vs2_val[i]),&nbsp;signed(rs1_val))</span></span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;signed&nbsp;overflow&nbsp;case&nbsp;returns&nbsp;zero&nbsp;naturally&nbsp;as&nbsp;required&nbsp;due&nbsp;to&nbsp;-1&nbsp;divisor&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_bits(SEW,&nbsp;r)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;mvxtype_mnemonic&nbsp;:&nbsp;mvxfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;MVX_VAADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vaaddu.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VAADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vaadd.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VASUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vasubu.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VASUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vasub.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VSLIDE1UP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vslide1up.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VSLIDE1DOWN&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vslide1down.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmul.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VMULH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmulh.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VMULHU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmulhu.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VMULHSU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmulhsu.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VDIVU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vdivu.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VDIV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vdiv.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VREMU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vremu.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VREM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vrem.vx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;mvxtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;*************************&nbsp;OPMVX&nbsp;(VXtype&nbsp;Multiply-Add)&nbsp;*************************&nbsp;*/<br>
/*&nbsp;Multiply-Add&nbsp;instructions&nbsp;switch&nbsp;the&nbsp;order&nbsp;of&nbsp;source&nbsp;operands&nbsp;in&nbsp;assembly&nbsp;(vs1/rs1&nbsp;before&nbsp;vs2)&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;MVXMATYPE&nbsp;:&nbsp;(mvxmafunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_mvxmafunct6&nbsp;:&nbsp;mvxmafunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VMACC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VNMSAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VMADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">MVX_VNMSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b101011<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;MVXMATYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_mvxmafunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b110&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(MVXMATYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_normal(vd,&nbsp;vm)&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 60%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 55%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VMACC&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(rs1_val)&nbsp;*&nbsp;signed(vs2_val[i]),&nbsp;0)&nbsp;+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VNMSAC&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vd_val[i]&nbsp;-&nbsp;get_slice_int(SEW,&nbsp;signed(rs1_val)&nbsp;*&nbsp;signed(vs2_val[i]),&nbsp;0)</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VMADD&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">get_slice_int(SEW,&nbsp;signed(rs1_val)&nbsp;*&nbsp;signed(vd_val[i]),&nbsp;0)&nbsp;+&nbsp;vs2_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVX_VNMSUB&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 50%)">vs2_val[i]&nbsp;-&nbsp;get_slice_int(SEW,&nbsp;signed(rs1_val)&nbsp;*&nbsp;signed(vd_val[i]),&nbsp;0)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;mvxmatype_mnemonic&nbsp;:&nbsp;mvxmafunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;MVX_VMACC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmacc.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VNMSAC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnmsac.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VMADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vmadd.vx&quot;</span>,<br>
&nbsp;&nbsp;MVX_VNMSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vnmsub.vx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;MVXMATYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;mvxmatype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;***************************&nbsp;OPMVX&nbsp;(VXTYPE&nbsp;Widening)&nbsp;***************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;WVXTYPE&nbsp;:&nbsp;(wvxfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_wvxfunct6&nbsp;:&nbsp;wvxfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110001,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VSUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110010,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VWMUL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111011,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VWMULU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111000,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WVX_VWMULSU</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111010<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;WVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_wvxfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b110&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(WVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VADD&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;+&nbsp;signed(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VSUB&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;-&nbsp;signed(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VADDU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;+&nbsp;unsigned(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VSUBU&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;-&nbsp;unsigned(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VWMUL&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;signed(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VWMULU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;*&nbsp;unsigned(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WVX_VWMULSU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;*&nbsp;unsigned(rs1_val))</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;wvxtype_mnemonic&nbsp;:&nbsp;wvxfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;WVX_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwadd.vx&quot;</span>,<br>
&nbsp;&nbsp;WVX_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsub.vx&quot;</span>,<br>
&nbsp;&nbsp;WVX_VADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwaddu.vx&quot;</span>,<br>
&nbsp;&nbsp;WVX_VSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsubu.vx&quot;</span>,<br>
&nbsp;&nbsp;WVX_VWMUL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmul.vx&quot;</span>,<br>
&nbsp;&nbsp;WVX_VWMULU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmulu.vx&quot;</span>,<br>
&nbsp;&nbsp;WVX_VWMULSU&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmulsu.vx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;WVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;wvxtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;***************************&nbsp;OPMVX&nbsp;(WXTYPE&nbsp;Widening)&nbsp;***************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;WXTYPE&nbsp;:&nbsp;(wxfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_wxfunct6&nbsp;:&nbsp;wxfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WX_VADD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WX_VSUB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110111,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WX_VADDU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WX_VSUBU</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b110110<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;WXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_wxfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b110&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(WXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)<br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WX_VADD&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;+&nbsp;signed(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WX_VSUB&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;signed(vs2_val[i])&nbsp;-&nbsp;signed(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WX_VADDU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;+&nbsp;unsigned(rs1_val))</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WX_VSUBU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">to_bits(SEW_widen,&nbsp;unsigned(vs2_val[i])&nbsp;-&nbsp;unsigned(rs1_val))</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;wxtype_mnemonic&nbsp;:&nbsp;wxfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;WX_VADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwadd.wx&quot;</span>,<br>
&nbsp;&nbsp;WX_VSUB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsub.wx&quot;</span>,<br>
&nbsp;&nbsp;WX_VADDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwaddu.wx&quot;</span>,<br>
&nbsp;&nbsp;WX_VSUBU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwsubu.wx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;WXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;wxtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;********************&nbsp;OPMVX&nbsp;(VXtype&nbsp;Widening&nbsp;Multiply-Add)&nbsp;*********************&nbsp;*/<br>
/*&nbsp;Multiply-Add&nbsp;instructions&nbsp;switch&nbsp;the&nbsp;order&nbsp;of&nbsp;source&nbsp;operands&nbsp;in&nbsp;assembly&nbsp;(vs1/rs1&nbsp;before&nbsp;vs2)&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;&nbsp;WMVXTYPE&nbsp;:&nbsp;(wmvxfunct6,&nbsp;bits(1),&nbsp;regidx,&nbsp;regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;encdec_wmvxfunct6&nbsp;:&nbsp;wmvxfunct6&nbsp;&lt;-&gt;&nbsp;bits(6)&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVX_VWMACCU</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111100,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVX_VWMACC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111101,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVX_VWMACCUS</span>&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111110,<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">WMVX_VWMACCSU</span>&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;0b111111<br>
}<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;WMVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 75%)"><span style="background-color: hsl(0, 85%, 75%)">encdec_wmvxfunct6(funct6)&nbsp;@&nbsp;vm&nbsp;@&nbsp;vs2&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b110&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(WMVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow&nbsp;=&nbsp;get_lmul_pow();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(LMUL_pow,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;SEW_widen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SEW&nbsp;*&nbsp;2;<br>
&nbsp;&nbsp;let&nbsp;LMUL_pow_widen&nbsp;=&nbsp;LMUL_pow&nbsp;+&nbsp;1;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">illegal_variable_width(vd,&nbsp;vm,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen)&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">not(valid_reg_overlap(vs2,&nbsp;vd,&nbsp;LMUL_pow,&nbsp;LMUL_pow_widen))</span></span><br>
&nbsp;&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">let&nbsp;'o&nbsp;=&nbsp;SEW_widen;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;vm,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;SEW);<br>
&nbsp;&nbsp;let&nbsp;vs2_val&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;LMUL_pow,&nbsp;vs2);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('o))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;0&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">if&nbsp;mask[i]&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 55%)">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 50%)">match&nbsp;funct6&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVX_VWMACCU&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">(to_bits(SEW_widen,&nbsp;unsigned(rs1_val)&nbsp;*&nbsp;unsigned(vs2_val[i])&nbsp;))&nbsp;+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVX_VWMACC&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">(to_bits(SEW_widen,&nbsp;signed(rs1_val)&nbsp;*&nbsp;signed(vs2_val[i])&nbsp;))&nbsp;+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVX_VWMACCUS&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">(to_bits(SEW_widen,&nbsp;unsigned(rs1_val)&nbsp;*&nbsp;signed(vs2_val[i])&nbsp;))+&nbsp;vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMVX_VWMACCSU&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 45%)">(to_bits(SEW_widen,&nbsp;signed(rs1_val)&nbsp;*&nbsp;unsigned(vs2_val[i])&nbsp;))+&nbsp;vd_val[i]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 65%)">&#171;Invisible branch not taken here&#187</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW_widen,&nbsp;LMUL_pow_widen,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span></span><br>
}</span><br>
<br>
mapping&nbsp;wmvxtype_mnemonic&nbsp;:&nbsp;wmvxfunct6&nbsp;&lt;-&gt;&nbsp;string&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;WMVX_VWMACCU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmaccu.vx&quot;</span>,<br>
&nbsp;&nbsp;WMVX_VWMACC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmacc.vx&quot;</span>,<br>
&nbsp;&nbsp;WMVX_VWMACCUS&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmaccus.vx&quot;</span>,<br>
&nbsp;&nbsp;WMVX_VWMACCSU&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">&quot;vwmaccsu.vx&quot;</span><br>
}<br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;WMVXTYPE(funct6,&nbsp;vm,&nbsp;vs2,&nbsp;rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;wmvxtype_mnemonic(funct6)&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;vreg_name(vs2)&nbsp;^&nbsp;maybe_vmask(vm)<br>
<br>
/*&nbsp;******************************&nbsp;OPMVX&nbsp;(VRXUNARY0)&nbsp;******************************&nbsp;*/<br>
union&nbsp;clause&nbsp;ast&nbsp;=&nbsp;VMVSX&nbsp;:&nbsp;(regidx,&nbsp;regidx)<br>
<br>
mapping&nbsp;clause&nbsp;encdec&nbsp;=&nbsp;VMVSX(rs1,&nbsp;vd)&nbsp;if&nbsp;haveVExt()<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;<span style="background-color: hsl(0, 85%, 80%)">0b010000&nbsp;@&nbsp;0b1&nbsp;@&nbsp;0b00000&nbsp;@&nbsp;rs1&nbsp;@&nbsp;0b110&nbsp;@&nbsp;vd&nbsp;@&nbsp;0b1010111</span>&nbsp;if&nbsp;<span style="background-color: hsl(0, 85%, 80%)">haveVExt()</span><br>
<br>
function&nbsp;clause&nbsp;execute(VMVSX(rs1,&nbsp;vd))&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 80%)">{<br>
&nbsp;&nbsp;let&nbsp;SEW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_sew();<br>
&nbsp;&nbsp;let&nbsp;num_elem&nbsp;=&nbsp;get_num_elem(0,&nbsp;SEW);<br>
<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">if&nbsp;illegal_vd_unmasked()&nbsp;then&nbsp;<span style="background-color: hsl(0, 85%, 70%)">{&nbsp;handle_illegal();&nbsp;return&nbsp;RETIRE_FAIL&nbsp;}</span></span><span style="background-color: hsl(0, 85%, 80%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;assert(num_elem&nbsp;&gt;&nbsp;0);<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 75%)">let&nbsp;'n&nbsp;=&nbsp;num_elem;<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 70%)">let&nbsp;'m&nbsp;=&nbsp;SEW;<br>
<br>
&nbsp;&nbsp;let&nbsp;vm_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;read_vmask(num_elem,&nbsp;0b1,&nbsp;0b00000);<br>
&nbsp;&nbsp;let&nbsp;rs1_val&nbsp;:&nbsp;bits('m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;get_scalar(rs1,&nbsp;'m);<br>
&nbsp;&nbsp;let&nbsp;vd_val&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;read_vreg(num_elem,&nbsp;SEW,&nbsp;0,&nbsp;vd);<br>
&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bits('m))&nbsp;=&nbsp;undefined;<br>
&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;vector('n,&nbsp;dec,&nbsp;bool)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;undefined;<br>
<br>
&nbsp;&nbsp;(result,&nbsp;mask)&nbsp;=&nbsp;init_masked_result(num_elem,&nbsp;SEW,&nbsp;0,&nbsp;vd_val,&nbsp;vm_val);<br>
<br>
&nbsp;&nbsp;/*&nbsp;one&nbsp;body&nbsp;element&nbsp;*/<br>
&nbsp;&nbsp;<span style="background-color: hsl(0, 85%, 65%)">if&nbsp;mask[0]&nbsp;then&nbsp;result[0]&nbsp;=&nbsp;rs1_val</span><span style="background-color: hsl(0, 85%, 70%)">&#171;Invisible branch not taken here&#187</span>;<br>
<br>
&nbsp;&nbsp;/*&nbsp;others&nbsp;treated&nbsp;as&nbsp;tail&nbsp;elements&nbsp;*/<br>
&nbsp;&nbsp;let&nbsp;tail_ag&nbsp;:&nbsp;agtype&nbsp;=&nbsp;get_vtype_vta();<br>
&nbsp;&nbsp;foreach&nbsp;(i&nbsp;from&nbsp;1&nbsp;to&nbsp;(num_elem&nbsp;-&nbsp;1))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;result[i]&nbsp;=&nbsp;<span style="background-color: hsl(0, 85%, 65%)">match&nbsp;tail_ag&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNDISTURBED&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">vd_val[i]</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGNOSTIC&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span style="background-color: hsl(0, 85%, 60%)">vd_val[i]</span>&nbsp;/*&nbsp;TODO:&nbsp;configuration&nbsp;support&nbsp;*/<br>
&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;write_vreg(num_elem,&nbsp;SEW,&nbsp;0,&nbsp;vd,&nbsp;result);<br>
&nbsp;&nbsp;vstart&nbsp;=&nbsp;zeros();<br>
&nbsp;&nbsp;RETIRE_SUCCESS</span></span><br>
}</span><br>
<br>
mapping&nbsp;clause&nbsp;assembly&nbsp;=&nbsp;VMVSX(rs1,&nbsp;vd)<br>
&nbsp;&nbsp;&lt;-&gt;&nbsp;&quot;vmv.s.x&quot;&nbsp;^&nbsp;spc()&nbsp;^&nbsp;vreg_name(vd)&nbsp;^&nbsp;sep()&nbsp;^&nbsp;reg_name(rs1)<br>
</code>
</body>
</html>
